<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedWord - Medical Terminology Game</title>
    <meta name="description" content="Learn medical terminology and abbreviations in a fun and interactive way">
    <meta name="theme-color" content="#4158D0">
    
    <!-- iOS PWA specific -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="MedWord">
    
    <!-- App Icon -->
    <link rel="icon" href="assets/images/manifest-icon-192.png" type="image/png">
    <link rel="apple-touch-icon" href="assets/images/apple-icon-180.png">
    
    <!-- iOS Splash Screens -->
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2048-2732.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2732-2048.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1668-2388.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2388-1668.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1536-2048.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2048-1536.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1668-2224.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2224-1668.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1620-2160.png" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2160-1620.png" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1290-2796.png" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2796-1290.png" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1179-2556.png" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2556-1179.png" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1284-2778.png" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2778-1284.png" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1170-2532.png" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2532-1170.png" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1125-2436.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2436-1125.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1242-2688.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2688-1242.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-828-1792.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1792-828.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1242-2208.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-2208-1242.png" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-750-1334.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1334-750.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-640-1136.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="assets/images/apple-splash-1136-640.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Existing scripts and styles -->
    <script src="assets/js/tailwind.min.js"></script>
    <script src="assets/js/alpinejs.min.js" defer></script>

    <style>
        @font-face {
            font-family: 'Lato';
            src: url('assets/fonts/Lato-Regular.woff2') format('woff2');
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
            font-family: 'Lato';
            src: url('assets/fonts/Lato-Bold.woff2') format('woff2');
            font-weight: 700;
            font-style: normal;
            font-display: swap;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #4158D0, #C850C0);
            --secondary-gradient: linear-gradient(135deg, #43cea2, #185a9d);
            --tertiary-gradient: linear-gradient(135deg, #ff8008, #ffc837);
            --dark-gradient: linear-gradient(135deg, #141E30, #243B55);
            --danger-gradient: linear-gradient(135deg, #f85032, #e73827);
            --success-gradient: linear-gradient(135deg, #56ab2f, #a8e063);
            --shop-gradient: linear-gradient(135deg, #9D50BB, #6E48AA);

            /* Theme gradients */
            --ocean-primary: linear-gradient(135deg, #2193b0, #6dd5ed);
            --ocean-secondary: linear-gradient(135deg, #4AC29A, #BDFFF3);
            --ocean-tertiary: linear-gradient(135deg, #0083B0, #00B4DB);

            --sunset-primary: linear-gradient(135deg, #FF416C, #FF4B2B);
            --sunset-secondary: linear-gradient(135deg, #f953c6, #b91d73);
            --sunset-tertiary: linear-gradient(135deg, #F2994A, #F2C94C);

            --forest-primary: linear-gradient(135deg, #134E5E, #71B280);
            --forest-secondary: linear-gradient(135deg, #0F9B0F, #8BC34A);
            --forest-tertiary: linear-gradient(135deg, #2C5364, #203A43);
        }

        body {
            font-family: 'Lato', sans-serif;
            background: #f0f4f8;
            overflow-x: hidden;
        }

        .app-container {
            max-width: 500px;
            min-height: 100vh;
            margin: 0 auto;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MCIgaGVpZ2h0PSI1MCI+CjxyZWN0IHdpZHRoPSI1MCIgaGVpZ2h0PSI1MCIgZmlsbD0iI2ZhZmFmYSI+PC9yZWN0Pgo8Y2lyY2xlIGN4PSIxMCIgY3k9IjEwIiByPSIyIiBmaWxsPSIjZTBlNWVjIj48L2NpcmNsZT4KPGNpcmNsZSBjeD0iNDAiIGN5PSIxMCIgcj0iMiIgZmlsbD0iI2UwZTVlYyI+PC9jaXJjbGU+CjxjaXJjbGUgY3g9IjEwIiBjeT0iNDAiIHI9IjIiIGZpbGw9IiNlMGU1ZWMiPjwvY2lyY2xlPgo8Y2lyY2xlIGN4PSI0MCIgY3k9IjQwIiByPSIyIiBmaWxsPSIjZTBlNWVjIj48L2NpcmNsZT4KPGNpcmNsZSBjeD0iMjUiIGN5PSIyNSIgcj0iMiIgZmlsbD0iI2UwZTVlYyI+PC9jaXJjbGU+Cjwvc3ZnPg==');
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .bg-primary-gradient {
            background-image: var(--primary-gradient);
        }

        .bg-secondary-gradient {
            background-image: var(--secondary-gradient);
        }

        .bg-tertiary-gradient {
            background-image: var(--tertiary-gradient);
        }

        .bg-dark-gradient {
            background-image: var(--dark-gradient);
        }

        .bg-danger-gradient {
            background-image: var(--danger-gradient);
        }

        .bg-success-gradient {
            background-image: var(--success-gradient);
        }

        .bg-shop-gradient {
            background-image: var(--shop-gradient);
        }

        /* Theme classes */
        .theme-ocean .bg-primary-gradient {
            background-image: var(--ocean-primary);
        }

        .theme-ocean .bg-secondary-gradient {
            background-image: var(--ocean-secondary);
        }

        .theme-ocean .bg-tertiary-gradient {
            background-image: var(--ocean-tertiary);
        }

        .theme-sunset .bg-primary-gradient {
            background-image: var(--sunset-primary);
        }

        .theme-sunset .bg-secondary-gradient {
            background-image: var(--sunset-secondary);
        }

        .theme-sunset .bg-tertiary-gradient {
            background-image: var(--sunset-tertiary);
        }

        .theme-forest .bg-primary-gradient {
            background-image: var(--forest-primary);
        }

        .theme-forest .bg-secondary-gradient {
            background-image: var(--forest-secondary);
        }

        .theme-forest .bg-tertiary-gradient {
            background-image: var(--forest-tertiary);
        }

        .btn {
            transition: all 0.3s ease;
            transform: translateY(0);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(0, 0, 0, 0.15);
        }

        .btn:active {
            transform: translateY(1px);
        }

        .letter-tile {
            @apply flex items-center justify-center text-xl font-bold rounded-lg shadow-md cursor-pointer transform transition-all duration-200;
            background-image: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            width: 50px;
            height: 50px;
        }

        .letter-tile:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .letter-tile.selected {
            background-image: var(--primary-gradient);
            color: white;
            transform: translateY(-4px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        .letter-tile.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .answer-tile {
            @apply flex items-center justify-center text-lg font-bold rounded-md shadow-sm;
            background-color: #f5f7fa;
            width: 40px;
            height: 40px;
            border: 2px dashed #c3cfe2;
        }

        .answer-tile.filled {
            border: none;
            background-image: linear-gradient(135deg, #4158D0, #C850C0);
            color: white;
            animation: pulse 1.5s infinite;
        }

        .theme-ocean .answer-tile.filled {
            background-image: var(--ocean-primary);
        }

        .theme-sunset .answer-tile.filled {
            background-image: var(--sunset-primary);
        }

        .theme-forest .answer-tile.filled {
            background-image: var(--forest-primary);
        }

        .grid-cell {
            width: 35px;
            height: 35px;
            @apply flex items-center justify-center text-sm font-bold rounded-md border-2 border-gray-300 cursor-pointer transition-all;
        }

        .grid-cell.highlighted {
            background-image: var(--secondary-gradient);
            color: white;
            transform: scale(1.05);
            z-index: 10;
        }

        .grid-cell.found {
            background-image: var(--success-gradient);
            color: white;
            transform: none;
        }

        .coin {
            animation: spin 4s linear infinite;
        }

        .shop-item {
            transition: all 0.3s ease;
            transform: translateY(0);
        }

        .shop-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .shop-item.disabled {
            opacity: 0.6;
            transform: none;
        }

        .custom-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236b7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
            background-size: 1.5em 1.5em;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(192, 80, 192, 0.4);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(192, 80, 192, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(192, 80, 192, 0);
            }
        }

        @keyframes spin {
            0% {
                transform: rotateY(0deg);
            }

            100% {
                transform: rotateY(360deg);
            }
        }

        @keyframes float {
            0% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }

            100% {
                transform: translateY(0px);
            }
        }

        .float-animation {
            animation: float 3s ease-in-out infinite;
        }

        .splash-icon {
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.2));
        }

        .progress-bar {
            height: 8px;
            background-image: var(--secondary-gradient);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .modal {
            backdrop-filter: blur(5px);
        }

        .flip-card {
            perspective: 1000px;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flip-card.flipped {
            transform: rotateY(180deg);
        }

        .flip-card-front,
        .flip-card-back {
            backface-visibility: hidden;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .flip-card-back {
            transform: rotateY(180deg);
        }

        .slide-in {
            animation: slideIn 0.5s forwards;
        }

        @keyframes slideIn {
            from {
                transform: translateY(50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .fade-in {
            animation: fadeIn 0.5s forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .bounce {
            animation: bounce 0.5s;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }
    </style>
</head>

<body>
    <div class="app-container" x-data="gameApp()"
        :class="{'theme-ocean': inventory.activeTheme === 'ocean', 'theme-sunset': inventory.activeTheme === 'sunset', 'theme-forest': inventory.activeTheme === 'forest'}">
        <!-- Audio elements -->
        <audio id="bgMusic" loop>
            <source src="https://assets.mixkit.co/music/preview/mixkit-game-show-puzzle-waiting-682.mp3"
                type="audio/mpeg">
        </audio>
        <audio id="correctSound">
            <source src="https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3"
                type="audio/mpeg">
        </audio>
        <audio id="wrongSound">
            <source src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"
                type="audio/mpeg">
        </audio>
        <audio id="coinSound">
            <source src="https://assets.mixkit.co/sfx/preview/mixkit-coin-win-notification-1992.mp3" type="audio/mpeg">
        </audio>
        <audio id="purchaseSound">
            <source src="https://assets.mixkit.co/sfx/preview/mixkit-fantasy-game-success-notification-270.mp3"
                type="audio/mpeg">
        </audio>

        <!-- Splash Screen -->
        <div x-show="currentScreen === 'splash'"
            class="h-screen flex flex-col items-center justify-center bg-white py-10 px-6 space-y-8 fade-in">
            <div class="text-center">
                <div class="flex justify-center">
                    <img src="assets/images/medword-logo.png" class="w-32 h-32 splash-icon" alt="MedWord Logo">
                </div>
                <p class="text-gray-600 mt-2">Master Medical Terminology Through Play</p>
            </div>

            <div class="bg-blue-50 p-4 rounded-lg shadow-md w-full max-w-md">
                <h3 class="font-bold text-blue-800">Today's Tip:</h3>
                <p class="text-blue-700 text-sm" x-text="randomTip"></p>
            </div>

            <button @click="splashProgress >= 100 ? startGame() : null"
                :class="{'cursor-not-allowed opacity-70': splashProgress < 100, 'cursor-pointer': splashProgress >= 100}"
                class="btn bg-primary-gradient text-white font-bold py-4 px-10 rounded-full text-lg">
                <span x-show="splashProgress < 100">Loading...</span>
                <span x-show="splashProgress >= 100">Start Game</span>
            </button>

            <div class="mt-4 text-gray-500 text-sm">
                <p>Loading medical terms... <span x-text="Math.floor(splashProgress) + '%'"></span></p>
                <div class="w-64 h-2 bg-gray-200 rounded-full mt-2">
                    <div class="progress-bar" :style="`width: ${splashProgress}%`"></div>
                </div>
            </div>
        </div>

        <!-- Main Menu -->
        <div x-show="currentScreen === 'menu'" class="min-h-screen bg-white flex flex-col slide-in">
            <!-- Header -->
            <div class="bg-primary-gradient text-white p-6 rounded-b-3xl shadow-lg">
                <div class="flex justify-between items-center">
                    <h1 class="text-3xl font-black">MedWord</h1>
                    <div class="flex items-center bg-white bg-opacity-20 px-4 py-2 rounded-full">
                        <img src="assets/images/coin.png" class="w-6 h-6 coin mr-2" alt="Coins">
                        <span class="font-bold" x-text="coins"></span>
                    </div>
                </div>
                <p class="mt-2 text-white text-opacity-80">Master Medical Terminology</p>
            </div>

            <!-- Menu Options -->
            <div class="flex-1 p-6 space-y-6">
                <div class="grid grid-cols-2 gap-4">
                    <button @click="showGameMode()"
                        class="btn bg-secondary-gradient text-white p-6 rounded-2xl shadow-md flex flex-col items-center justify-center">
                        <div class="flex justify-center items-center mb-3">
                            <img src="assets/images/play.png" class="w-16 h-16" alt="Play">
                        </div>
                        <span class="font-bold text-lg">Play</span>
                    </button>

                    <button @click="currentScreen = 'shop'"
                        class="btn bg-shop-gradient text-white p-6 rounded-2xl shadow-md flex flex-col items-center justify-center">
                        <div class="flex justify-center items-center mb-3">
                            <img src="assets/images/shop.png" class="w-16 h-16" alt="Shop">
                        </div>
                        <span class="font-bold text-lg">Shop</span>
                    </button>

                    <button @click="currentScreen = 'progress'"
                        class="btn bg-tertiary-gradient text-white p-6 rounded-2xl shadow-md flex flex-col items-center justify-center">
                        <div class="flex justify-center items-center mb-3">
                            <img src="assets/images/progress.png" class="w-16 h-16" alt="Progress">
                        </div>
                        <span class="font-bold text-lg">Progress</span>
                    </button>

                    <div class="grid grid-cols-2 gap-2">
                        <button @click="currentScreen = 'settings'"
                            class="btn bg-dark-gradient text-white p-4 rounded-2xl shadow-md flex flex-col items-center justify-center">
                            <div class="flex justify-center items-center mb-2">
                                <img src="assets/images/settings.png" class="w-10 h-10" alt="Settings">
                            </div>
                            <span class="font-bold text-sm">Settings</span>
                        </button>

                        <button @click="currentScreen = 'about'"
                            class="btn bg-primary-gradient text-white p-4 rounded-2xl shadow-md flex flex-col items-center justify-center">
                            <div class="flex justify-center items-center mb-2">
                                <img src="assets/images/about.png" class="w-10 h-10" alt="About">
                            </div>
                            <span class="font-bold text-sm">About</span>
                        </button>
                    </div>
                </div>

                <div class="bg-blue-50 p-4 rounded-xl shadow">
                    <h3 class="font-bold text-blue-800">Daily Challenge</h3>
                    <p class="text-blue-700 text-sm">Complete 5 games today to earn 50 bonus coins!</p>
                    <div class="flex mt-2 space-x-1">
                        <template x-for="i in 5">
                            <div :class="{'bg-blue-500': dailyProgress >= i, 'bg-gray-300': dailyProgress < i}"
                                class="w-full h-2 rounded-full"></div>
                        </template>
                    </div>
                </div>

                <div x-show="!claimedFreeCoins"
                    class="bg-yellow-50 p-4 rounded-xl shadow border-2 border-yellow-200 flex justify-between items-center">
                    <div>
                        <h3 class="font-bold text-yellow-800">Free Coins!</h3>
                        <p class="text-yellow-700 text-sm">Claim your one-time bonus of 100 coins</p>
                    </div>
                    <button @click="claimFreeCoins()"
                        class="btn bg-yellow-500 text-white font-bold py-2 px-4 rounded-lg">
                        Claim
                    </button>
                </div>
            </div>
        </div>

        <!-- Shop Screen -->
        <div x-show="currentScreen === 'shop'" class="min-h-screen bg-white flex flex-col slide-in">
            <div class="bg-shop-gradient text-white p-6 rounded-b-3xl shadow-lg">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <button @click="currentScreen = 'menu'" class="mr-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 19l-7-7 7-7" />
                            </svg>
                        </button>
                        <h1 class="text-2xl font-bold">Shop</h1>
                    </div>
                    <div class="flex items-center bg-white bg-opacity-20 px-4 py-2 rounded-full">
                        <img src="assets/images/coin.png" class="w-6 h-6 coin mr-2" alt="Coins">
                        <span class="font-bold" x-text="coins"></span>
                    </div>
                </div>
            </div>

            <div class="flex-1 p-6 space-y-6 overflow-y-auto">
                <!-- Shop Categories -->
                <div class="flex overflow-x-auto space-x-2 pb-2">
                    <button @click="shopCategory = 'powerups'"
                        :class="{'bg-shop-gradient text-white': shopCategory === 'powerups', 'bg-gray-200 text-gray-700': shopCategory !== 'powerups'}"
                        class="px-5 py-2 rounded-full font-bold whitespace-nowrap flex-shrink-0">
                        Power-ups
                    </button>
                    <button @click="shopCategory = 'packs'"
                        :class="{'bg-shop-gradient text-white': shopCategory === 'packs', 'bg-gray-200 text-gray-700': shopCategory !== 'packs'}"
                        class="px-5 py-2 rounded-full font-bold whitespace-nowrap flex-shrink-0">
                        Term Packs
                    </button>
                    <button @click="shopCategory = 'themes'"
                        :class="{'bg-shop-gradient text-white': shopCategory === 'themes', 'bg-gray-200 text-gray-700': shopCategory !== 'themes'}"
                        class="px-5 py-2 rounded-full font-bold whitespace-nowrap flex-shrink-0">
                        Themes
                    </button>
                </div>

                <!-- Power-ups Section -->
                <div x-show="shopCategory === 'powerups'" class="space-y-4">
                    <h2 class="text-xl font-bold text-gray-800">Power-ups</h2>

                    <div class="grid grid-cols-1 gap-4">
                        <!-- Anesthesia Pack -->
                        <div :class="{'shop-item': true, 'disabled': coins < 100}"
                            class="bg-white rounded-xl shadow-lg overflow-hidden">
                            <div class="flex">
                                <div class="w-1/3 bg-purple-100 p-4 flex items-center justify-center">
                                    <img src="assets/images/anesthesia.png" class="w-20 h-20" alt="Anesthesia">
                                </div>
                                <div class="w-2/3 p-4">
                                    <h3 class="font-bold text-lg text-gray-800">Anesthesia Pack</h3>
                                    <p class="text-gray-600 text-sm mb-3">Freeze the timer in Time Mode for 10 seconds.
                                        Pack of 5.</p>
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center">
                                            <img src="assets/images/coin.png" class="w-5 h-5 coin mr-1" alt="Coins">
                                            <span class="font-bold text-yellow-600">100</span>
                                        </div>
                                        <button @click="buyItem('anesthesiaPack')" :disabled="coins < 100"
                                            :class="{'opacity-50 cursor-not-allowed': coins < 100}"
                                            class="btn bg-shop-gradient text-white font-bold py-1 px-4 rounded-lg">
                                            Buy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Hint Pack -->
                        <div :class="{'shop-item': true, 'disabled': coins < 80}"
                            class="bg-white rounded-xl shadow-lg overflow-hidden">
                            <div class="flex">
                                <div class="w-1/3 bg-blue-100 p-4 flex items-center justify-center">
                                    <img src="assets/images/hints.png" class="w-20 h-20" alt="Hint">
                                </div>
                                <div class="w-2/3 p-4">
                                    <h3 class="font-bold text-lg text-gray-800">Hint Pack</h3>
                                    <p class="text-gray-600 text-sm mb-3">Reveals a letter in Classic Mode. Pack of 10
                                        hints.</p>
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center">
                                            <img src="assets/images/coin.png" class="w-5 h-5 coin mr-1" alt="Coins">
                                            <span class="font-bold text-yellow-600">80</span>
                                        </div>
                                        <button @click="buyItem('hintPack')" :disabled="coins < 80"
                                            :class="{'opacity-50 cursor-not-allowed': coins < 80}"
                                            class="btn bg-shop-gradient text-white font-bold py-1 px-4 rounded-lg">
                                            Buy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Time Bonus -->
                        <div :class="{'shop-item': true, 'disabled': coins < 60}"
                            class="bg-white rounded-xl shadow-lg overflow-hidden">
                            <div class="flex">
                                <div class="w-1/3 bg-green-100 p-4 flex items-center justify-center">
                                    <img src="assets/images/time.png" class="w-20 h-20" alt="Time">
                                </div>
                                <div class="w-2/3 p-4">
                                    <h3 class="font-bold text-lg text-gray-800">Time Bonus</h3>
                                    <p class="text-gray-600 text-sm mb-3">Adds 30 seconds to the timer in Time Mode.
                                        Pack of 3.</p>
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center">
                                            <img src="assets/images/coin.png" class="w-5 h-5 coin mr-1" alt="Coins">
                                            <span class="font-bold text-yellow-600">60</span>
                                        </div>
                                        <button @click="buyItem('timeBonus')" :disabled="coins < 60"
                                            :class="{'opacity-50 cursor-not-allowed': coins < 60}"
                                            class="btn bg-shop-gradient text-white font-bold py-1 px-4 rounded-lg">
                                            Buy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Word Reveal -->
                        <div :class="{'shop-item': true, 'disabled': coins < 120}"
                            class="bg-white rounded-xl shadow-lg overflow-hidden">
                            <div class="flex">
                                <div class="w-1/3 bg-red-100 p-4 flex items-center justify-center">
                                    <img src="assets/images/reveal.png" class="w-20 h-20" alt="Reveal">
                                </div>
                                <div class="w-2/3 p-4">
                                    <h3 class="font-bold text-lg text-gray-800">Word Reveal</h3>
                                    <p class="text-gray-600 text-sm mb-3">Instantly reveals one word in Time Mode. Pack
                                        of 2.</p>
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center">
                                            <img src="assets/images/coin.png" class="w-5 h-5 coin mr-1" alt="Coins">
                                            <span class="font-bold text-yellow-600">120</span>
                                        </div>
                                        <button @click="buyItem('wordReveal')" :disabled="coins < 120"
                                            :class="{'opacity-50 cursor-not-allowed': coins < 120}"
                                            class="btn bg-shop-gradient text-white font-bold py-1 px-4 rounded-lg">
                                            Buy
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Term Packs Section -->
                <div x-show="shopCategory === 'packs'" class="space-y-4">
                    <h2 class="text-xl font-bold text-gray-800">Term Packs</h2>

                    <div class="grid grid-cols-1 gap-4">
                        <!-- Cardiology Pack -->
                        <div :class="{'shop-item': true, 'disabled': coins < 150 || inventory.unlockedPacks.includes('cardiologyPack') || inventory.unlockedPacks.includes('premiumBundle')}"
                            class="bg-white rounded-xl shadow-lg overflow-hidden">
                            <div class="flex">
                                <div class="w-1/3 bg-red-100 p-4 flex items-center justify-center">
                                    <img src="assets/images/cardiology.png" class="w-20 h-20" alt="Cardiology">
                                </div>
                                <div class="w-2/3 p-4">
                                    <h3 class="font-bold text-lg text-gray-800">Cardiology Pack</h3>
                                    <p class="text-gray-600 text-sm mb-3">Unlock 15 cardiology terms and abbreviations.
                                    </p>
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center">
                                            <img src="assets/images/coin.png" class="w-5 h-5 coin mr-1" alt="Coins">
                                            <span class="font-bold text-yellow-600">150</span>
                                        </div>
                                        <template
                                            x-if="inventory.unlockedPacks.includes('cardiologyPack') || inventory.unlockedPacks.includes('premiumBundle')">
                                            <button class="btn bg-green-500 text-white font-bold py-1 px-4 rounded-lg">
                                                Owned
                                            </button>
                                        </template>
                                        <template
                                            x-if="!(inventory.unlockedPacks.includes('cardiologyPack') || inventory.unlockedPacks.includes('premiumBundle'))">
                                            <button @click="buyItem('cardiologyPack')" :disabled="coins < 150"
                                                :class="{'opacity-50 cursor-not-allowed': coins < 150}"
                                                class="btn bg-shop-gradient text-white font-bold py-1 px-4 rounded-lg">
                                                Buy
                                            </button>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Neurology Pack -->
                        <div :class="{'shop-item': true, 'disabled': coins < 150 || inventory.unlockedPacks.includes('neurologyPack') || inventory.unlockedPacks.includes('premiumBundle')}"
                            class="bg-white rounded-xl shadow-lg overflow-hidden">
                            <div class="flex">
                                <div class="w-1/3 bg-blue-100 p-4 flex items-center justify-center">
                                    <img src="assets/images/neurology.png" class="w-20 h-20" alt="Neurology">
                                </div>
                                <div class="w-2/3 p-4">
                                    <h3 class="font-bold text-lg text-gray-800">Neurology Pack</h3>
                                    <p class="text-gray-600 text-sm mb-3">Unlock 15 neurology terms and abbreviations.
                                    </p>
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center">
                                            <img src="assets/images/coin.png" class="w-5 h-5 coin mr-1" alt="Coins">
                                            <span class="font-bold text-yellow-600">150</span>
                                        </div>
                                        <template
                                            x-if="inventory.unlockedPacks.includes('neurologyPack') || inventory.unlockedPacks.includes('premiumBundle')">
                                            <button class="btn bg-green-500 text-white font-bold py-1 px-4 rounded-lg">
                                                Owned
                                            </button>
                                        </template>
                                        <template
                                            x-if="!(inventory.unlockedPacks.includes('neurologyPack') || inventory.unlockedPacks.includes('premiumBundle'))">
                                            <button @click="buyItem('neurologyPack')" :disabled="coins < 150"
                                                :class="{'opacity-50 cursor-not-allowed': coins < 150}"
                                                class="btn bg-shop-gradient text-white font-bold py-1 px-4 rounded-lg">
                                                Buy
                                            </button>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Pharmacology Pack -->
                        <div :class="{'shop-item': true, 'disabled': coins < 150 || inventory.unlockedPacks.includes('pharmacologyPack') || inventory.unlockedPacks.includes('premiumBundle')}"
                            class="bg-white rounded-xl shadow-lg overflow-hidden">
                            <div class="flex">
                                <div class="w-1/3 bg-green-100 p-4 flex items-center justify-center">
                                    <img src="assets/images/pharmacology.png" class="w-20 h-20" alt="Pharmacology">
                                </div>
                                <div class="w-2/3 p-4">
                                    <h3 class="font-bold text-lg text-gray-800">Pharmacology Pack</h3>
                                    <p class="text-gray-600 text-sm mb-3">Unlock 15 pharmacology terms and
                                        abbreviations.</p>
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center">
                                            <img src="assets/images/coin.png" class="w-5 h-5 coin mr-1" alt="Coins">
                                            <span class="font-bold text-yellow-600">150</span>
                                        </div>
                                        <template
                                            x-if="inventory.unlockedPacks.includes('pharmacologyPack') || inventory.unlockedPacks.includes('premiumBundle')">
                                            <button class="btn bg-green-500 text-white font-bold py-1 px-4 rounded-lg">
                                                Owned
                                            </button>
                                        </template>
                                        <template
                                            x-if="!(inventory.unlockedPacks.includes('pharmacologyPack') || inventory.unlockedPacks.includes('premiumBundle'))">
                                            <button @click="buyItem('pharmacologyPack')" :disabled="coins < 150"
                                                :class="{'opacity-50 cursor-not-allowed': coins < 150}"
                                                class="btn bg-shop-gradient text-white font-bold py-1 px-4 rounded-lg">
                                                Buy
                                            </button>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Premium Bundle -->
                        <div :class="{'shop-item': true, 'disabled': coins < 400 || inventory.unlockedPacks.includes('premiumBundle')}"
                            class="bg-white rounded-xl shadow-lg overflow-hidden">
                            <div
                                class="bg-yellow-400 text-xs font-bold text-white py-1 px-3 absolute right-0 transform rotate-45 translate-x-6 translate-y-3 z-10">
                                BEST VALUE
                            </div>
                            <div class="flex">
                                <div class="w-1/3 bg-purple-100 p-4 flex items-center justify-center">
                                    <img src="assets/images/premium.png" class="w-20 h-20" alt="Premium">
                                </div>
                                <div class="w-2/3 p-4">
                                    <h3 class="font-bold text-lg text-gray-800">Premium Bundle</h3>
                                    <p class="text-gray-600 text-sm mb-3">Unlock all specialty packs (45+ terms) and
                                        save coins!</p>
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center">
                                            <img src="assets/images/coin.png" class="w-5 h-5 coin mr-1" alt="Coins">
                                            <span class="font-bold text-yellow-600">400</span>
                                        </div>
                                        <template x-if="inventory.unlockedPacks.includes('premiumBundle')">
                                            <button class="btn bg-green-500 text-white font-bold py-1 px-4 rounded-lg">
                                                Owned
                                            </button>
                                        </template>
                                        <template x-if="!inventory.unlockedPacks.includes('premiumBundle')">
                                            <button @click="buyItem('premiumBundle')" :disabled="coins < 400"
                                                :class="{'opacity-50 cursor-not-allowed': coins < 400}"
                                                class="btn bg-shop-gradient text-white font-bold py-1 px-4 rounded-lg">
                                                Buy
                                            </button>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Themes Section -->
                <div x-show="shopCategory === 'themes'" class="space-y-4">
                    <h2 class="text-xl font-bold text-gray-800">Themes</h2>

                    <div class="grid grid-cols-2 gap-4">
                        <!-- Default Theme -->
                        <div class="shop-item bg-white rounded-xl shadow-lg overflow-hidden">
                            <div class="h-32 bg-gradient-to-r from-blue-500 to-purple-600"></div>
                            <div class="p-3">
                                <h3 class="font-bold text-gray-800">Default</h3>
                                <div class="flex justify-between items-center mt-2">
                                    <span class="text-xs text-gray-500"
                                        x-text="inventory.activeTheme === 'default' ? 'Current' : ''"></span>
                                    <button @click="activateTheme('default')"
                                        :class="{'bg-gray-200 text-gray-800': inventory.activeTheme !== 'default', 'bg-green-500 text-white': inventory.activeTheme === 'default'}"
                                        class="btn font-bold py-1 px-3 rounded-lg text-xs">
                                        <span
                                            x-text="inventory.activeTheme === 'default' ? 'Active' : 'Activate'"></span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Ocean Theme -->
                        <div :class="{'shop-item': true, 'disabled': coins < 100 && !themeOwned('ocean')}"
                            class="bg-white rounded-xl shadow-lg overflow-hidden">
                            <div class="h-32 bg-gradient-to-r from-blue-400 to-teal-500"></div>
                            <div class="p-3">
                                <h3 class="font-bold text-gray-800">Ocean</h3>
                                <div class="flex justify-between items-center mt-2">
                                    <template x-if="!themeOwned('ocean')">
                                        <div class="flex items-center">
                                            <img src="assets/images/coin.png" class="w-4 h-4 coin mr-1" alt="Coins">
                                            <span class="font-bold text-yellow-600 text-xs">100</span>
                                        </div>
                                    </template>
                                    <template x-if="themeOwned('ocean')">
                                        <span class="text-xs text-gray-500"
                                            x-text="inventory.activeTheme === 'ocean' ? 'Current' : ''"></span>
                                    </template>
                                    <template x-if="themeOwned('ocean')">
                                        <button @click="activateTheme('ocean')"
                                            :class="{'bg-gray-200 text-gray-800': inventory.activeTheme !== 'ocean', 'bg-green-500 text-white': inventory.activeTheme === 'ocean'}"
                                            class="btn font-bold py-1 px-3 rounded-lg text-xs">
                                            <span
                                                x-text="inventory.activeTheme === 'ocean' ? 'Active' : 'Activate'"></span>
                                        </button>
                                    </template>
                                    <template x-if="!themeOwned('ocean')">
                                        <button @click="buyItem('oceanTheme')" :disabled="coins < 100"
                                            :class="{'opacity-50 cursor-not-allowed': coins < 100}"
                                            class="btn bg-shop-gradient text-white font-bold py-1 px-3 rounded-lg text-xs">
                                            Buy
                                        </button>
                                    </template>
                                </div>
                            </div>
                        </div>

                        <!-- Sunset Theme -->
                        <div :class="{'shop-item': true, 'disabled': coins < 100 && !themeOwned('sunset')}"
                            class="bg-white rounded-xl shadow-lg overflow-hidden">
                            <div class="h-32 bg-gradient-to-r from-orange-400 to-pink-500"></div>
                            <div class="p-3">
                                <h3 class="font-bold text-gray-800">Sunset</h3>
                                <div class="flex justify-between items-center mt-2">
                                    <template x-if="!themeOwned('sunset')">
                                        <div class="flex items-center">
                                            <img src="assets/images/coin.png" class="w-4 h-4 coin mr-1" alt="Coins">
                                            <span class="font-bold text-yellow-600 text-xs">100</span>
                                        </div>
                                    </template>
                                    <template x-if="themeOwned('sunset')">
                                        <span class="text-xs text-gray-500"
                                            x-text="inventory.activeTheme === 'sunset' ? 'Current' : ''"></span>
                                    </template>
                                    <template x-if="themeOwned('sunset')">
                                        <button @click="activateTheme('sunset')"
                                            :class="{'bg-gray-200 text-gray-800': inventory.activeTheme !== 'sunset', 'bg-green-500 text-white': inventory.activeTheme === 'sunset'}"
                                            class="btn font-bold py-1 px-3 rounded-lg text-xs">
                                            <span
                                                x-text="inventory.activeTheme === 'sunset' ? 'Active' : 'Activate'"></span>
                                        </button>
                                    </template>
                                    <template x-if="!themeOwned('sunset')">
                                        <button @click="buyItem('sunsetTheme')" :disabled="coins < 100"
                                            :class="{'opacity-50 cursor-not-allowed': coins < 100}"
                                            class="btn bg-shop-gradient text-white font-bold py-1 px-3 rounded-lg text-xs">
                                            Buy
                                        </button>
                                    </template>
                                </div>
                            </div>
                        </div>

                        <!-- Forest Theme -->
                        <div :class="{'shop-item': true, 'disabled': coins < 100 && !themeOwned('forest')}"
                            class="bg-white rounded-xl shadow-lg overflow-hidden">
                            <div class="h-32 bg-gradient-to-r from-green-400 to-emerald-600"></div>
                            <div class="p-3">
                                <h3 class="font-bold text-gray-800">Forest</h3>
                                <div class="flex justify-between items-center mt-2">
                                    <template x-if="!themeOwned('forest')">
                                        <div class="flex items-center">
                                            <img src="assets/images/coin.png" class="w-4 h-4 coin mr-1" alt="Coins">
                                            <span class="font-bold text-yellow-600 text-xs">100</span>
                                        </div>
                                    </template>
                                    <template x-if="themeOwned('forest')">
                                        <span class="text-xs text-gray-500"
                                            x-text="inventory.activeTheme === 'forest' ? 'Current' : ''"></span>
                                    </template>
                                    <template x-if="themeOwned('forest')">
                                        <button @click="activateTheme('forest')"
                                            :class="{'bg-gray-200 text-gray-800': inventory.activeTheme !== 'forest', 'bg-green-500 text-white': inventory.activeTheme === 'forest'}"
                                            class="btn font-bold py-1 px-3 rounded-lg text-xs">
                                            <span
                                                x-text="inventory.activeTheme === 'forest' ? 'Active' : 'Activate'"></span>
                                        </button>
                                    </template>
                                    <template x-if="!themeOwned('forest')">
                                        <button @click="buyItem('forestTheme')" :disabled="coins < 100"
                                            :class="{'opacity-50 cursor-not-allowed': coins < 100}"
                                            class="btn bg-shop-gradient text-white font-bold py-1 px-3 rounded-lg text-xs">
                                            Buy
                                        </button>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Inventory Section -->
                <div class="mt-8">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">My Inventory</h2>

                    <div class="bg-white rounded-xl shadow-lg p-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-purple-50 rounded-lg p-3">
                                <div class="flex items-center mb-1">
                                    <img src="assets/images/anesthesia.png" class="w-5 h-5 mr-2" alt="Anesthesia">
                                    <h3 class="font-bold text-purple-800">Anesthesia</h3>
                                </div>
                                <p class="text-purple-600 text-xs" x-text="`You have: ${inventory.anesthesia}`"></p>
                            </div>

                            <div class="bg-blue-50 rounded-lg p-3">
                                <div class="flex items-center mb-1">
                                    <img src="assets/images/hints.png" class="w-5 h-5 mr-2" alt="Hints">
                                    <h3 class="font-bold text-blue-800">Hints</h3>
                                </div>
                                <p class="text-blue-600 text-xs" x-text="`You have: ${inventory.hints}`"></p>
                            </div>

                            <div class="bg-green-50 rounded-lg p-3">
                                <div class="flex items-center mb-1">
                                    <img src="assets/images/time.png" class="w-5 h-5 mr-2" alt="Time Bonus">
                                    <h3 class="font-bold text-green-800">Time Bonus</h3>
                                </div>
                                <p class="text-green-600 text-xs" x-text="`You have: ${inventory.timeBonus}`"></p>
                            </div>

                            <div class="bg-red-50 rounded-lg p-3">
                                <div class="flex items-center mb-1">
                                    <img src="assets/images/reveal.png" class="w-5 h-5 mr-2" alt="Word Reveal">
                                    <h3 class="font-bold text-red-800">Word Reveal</h3>
                                </div>
                                <p class="text-red-600 text-xs" x-text="`You have: ${inventory.wordReveal}`"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Mode Selection -->
        <div x-show="currentScreen === 'gameMode'" class="min-h-screen bg-white flex flex-col slide-in">
            <div class="bg-secondary-gradient text-white p-6 rounded-b-3xl shadow-lg">
                <div class="flex items-center">
                    <button @click="currentScreen = 'menu'" class="mr-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                    </button>
                    <h1 class="text-2xl font-bold">Choose Game Mode</h1>
                </div>
            </div>

            <div class="flex-1 p-6 space-y-8">
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
                    <div class="bg-secondary-gradient text-white p-4">
                        <h2 class="text-xl font-bold">Select Difficulty</h2>
                    </div>
                    <div class="p-4 space-y-2">
                        <button @click="setDifficulty('easy')"
                            :class="{'border-green-500 bg-green-50': difficulty === 'easy'}"
                            class="btn w-full py-3 rounded-xl border-2 flex justify-between items-center px-4">
                            <span class="font-bold">Easy</span>
                            <span class="text-sm bg-green-100 text-green-800 px-2 py-1 rounded">Beginner</span>
                        </button>

                        <button @click="setDifficulty('medium')"
                            :class="{'border-yellow-500 bg-yellow-50': difficulty === 'medium'}"
                            class="btn w-full py-3 rounded-xl border-2 flex justify-between items-center px-4">
                            <span class="font-bold">Medium</span>
                            <span class="text-sm bg-yellow-100 text-yellow-800 px-2 py-1 rounded">Intermediate</span>
                        </button>

                        <button @click="setDifficulty('hard')"
                            :class="{'border-red-500 bg-red-50': difficulty === 'hard'}"
                            class="btn w-full py-3 rounded-xl border-2 flex justify-between items-center px-4">
                            <span class="font-bold">Hard</span>
                            <span class="text-sm bg-red-100 text-red-800 px-2 py-1 rounded">Advanced</span>
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-1 gap-6">
                    <div
                        class="bg-white rounded-2xl shadow-lg overflow-hidden transform transition-all hover:scale-105">
                        <div class="h-40 bg-cover bg-center"
                            style="background-image: url('https://img.freepik.com/free-vector/medical-healthcare-blue-color_1017-26807.jpg?w=1380&t=st=1700000000~exp=1700000600~hmac=example')">
                            <div class="h-full w-full bg-blue-900 bg-opacity-50 flex items-center justify-center">
                                <h3 class="text-white text-2xl font-bold">Classic Mode</h3>
                            </div>
                        </div>
                        <div class="p-4">
                            <p class="text-gray-600 mb-4">Learn at your own pace with no time pressure. Perfect for
                                mastering new terms.</p>
                            <button @click="startClassicMode()"
                                class="btn w-full bg-secondary-gradient text-white font-bold py-3 px-4 rounded-xl">
                                Start Classic Mode
                            </button>
                        </div>
                    </div>

                    <div
                        class="bg-white rounded-2xl shadow-lg overflow-hidden transform transition-all hover:scale-105">
                        <div class="h-40 bg-cover bg-center"
                            style="background-image: url('https://img.freepik.com/free-vector/abstract-medical-wallpaper-template-design_53876-61802.jpg?w=1380&t=st=1700000000~exp=1700000600~hmac=example')">
                            <div class="h-full w-full bg-purple-900 bg-opacity-50 flex items-center justify-center">
                                <h3 class="text-white text-2xl font-bold">Time-Based Mode</h3>
                            </div>
                        </div>
                        <div class="p-4">
                            <p class="text-gray-600 mb-4">Find as many words as possible within 2 minutes. Test your
                                speed and knowledge!</p>
                            <button @click="startTimeMode()"
                                class="btn w-full bg-primary-gradient text-white font-bold py-3 px-4 rounded-xl">
                                Start Time Mode
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Classic Mode Game Screen -->
        <div x-show="currentScreen === 'classicMode'" class="min-h-screen bg-white flex flex-col slide-in">
            <!-- Header with score and level info -->
            <div class="bg-secondary-gradient text-white p-4 rounded-b-3xl shadow-lg">
                <div class="flex justify-between items-center">
                    <button @click="confirmQuit = true" class="p-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>

                    <div class="flex items-center space-x-4">
                        <div class="flex items-center bg-white bg-opacity-20 px-3 py-1 rounded-full">
                            <img src="assets/images/coin.png" class="w-5 h-5 coin mr-1" alt="Coins">
                            <span class="font-bold" x-text="coins"></span>
                        </div>

                        <div class="flex items-center bg-white bg-opacity-20 px-3 py-1 rounded-full">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13 10V3L4 14h7v7l9-11h-7z" />
                            </svg>
                            <span class="font-bold" x-text="classicScore"></span>
                        </div>
                    </div>
                </div>

                <div class="mt-2 flex justify-between items-center">
                    <div>
                        <h2 class="text-xl font-bold"
                            x-text="`Question ${currentQuestionIndex + 1}/${classicQuestions.length}`"></h2>
                        <p class="text-sm text-white text-opacity-80"
                            x-text="`Difficulty: ${difficulty.charAt(0).toUpperCase() + difficulty.slice(1)}`"></p>
                    </div>

                    <div class="flex space-x-2">
                        <button @click="useHintItem()" :class="{'opacity-50': inventory.hints <= 0}"
                            class="btn bg-white bg-opacity-20 p-2 rounded-lg relative">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                            </svg>
                            <span
                                class="absolute -top-1 -right-1 bg-blue-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center"
                                x-text="inventory.hints"></span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="flex-1 p-6 space-y-6">
                <!-- Question section -->
                <div class="bg-white rounded-xl shadow-md p-4">
                    <h3 class="font-bold text-gray-700">What does this medical abbreviation stand for?</h3>
                    <div class="flex justify-center my-4">
                        <div class="bg-secondary-gradient text-white text-2xl font-bold py-3 px-8 rounded-lg shadow-md"
                            x-text="currentClassicQuestion?.abbreviation || ''"></div>
                    </div>
                    <p class="text-sm text-gray-500 italic" x-text="currentClassicQuestion?.hint || ''"></p>
                </div>

                <!-- Answer section -->
                <div class="bg-white rounded-xl shadow-md p-4">
                    <div class="flex flex-wrap justify-center gap-2 mb-6">
                        <template x-for="(letter, index) in answerArray" :key="index">
                            <div :class="{'answer-tile': true, 'filled': letter !== ' ', 'cursor-pointer': letter !== ' '}"
                                x-text="letter !== ' ' ? letter : ''" @click="removeLetter(index)"></div>
                        </template>
                    </div>

                    <div class="flex flex-wrap justify-center gap-3">
                        <template x-for="(letter, index) in shuffledLetters" :key="index">
                            <div :class="{'letter-tile': true, 'selected': selectedLetterIndices.includes(index), 'disabled': letter === ' '}"
                                @click="selectLetter(index)" x-text="letter"></div>
                        </template>
                    </div>
                </div>

                <!-- Action buttons -->
                <div class="flex space-x-4">
                    <button @click="clearAnswer()"
                        class="btn flex-1 bg-gray-200 text-gray-800 font-bold py-3 rounded-xl">
                        Clear
                    </button>
                    <button @click="submitAnswer()"
                        class="btn flex-1 bg-secondary-gradient text-white font-bold py-3 rounded-xl">
                        Submit
                    </button>
                </div>
            </div>
        </div>

        <!-- Time-Based Mode Game Screen -->
        <div x-show="currentScreen === 'timeMode'" class="min-h-screen bg-white flex flex-col slide-in">
            <!-- Header with timer and score -->
            <div class="bg-primary-gradient text-white p-4 rounded-b-3xl shadow-lg">
                <div class="flex justify-between items-center">
                    <button @click="confirmQuit = true" class="p-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>

                    <div class="flex items-center space-x-4">
                        <div class="flex items-center bg-white bg-opacity-20 px-3 py-1 rounded-full">
                            <img src="assets/images/coin.png" class="w-5 h-5 coin mr-1" alt="Coins">
                            <span class="font-bold" x-text="coins"></span>
                        </div>

                        <div class="flex items-center bg-white bg-opacity-20 px-3 py-1 rounded-full">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span class="font-bold" x-text="formatTime(timeRemaining)"></span>
                        </div>
                    </div>
                </div>

                <div class="mt-2 flex justify-between items-center">
                    <div>
                        <h2 class="text-xl font-bold">Time Challenge</h2>
                        <p class="text-sm text-white text-opacity-80">Find all the words!</p>
                    </div>

                    <div class="flex space-x-2">
                        <button @click="useAnesthesiaItem()"
                            :class="{'opacity-50': inventory.anesthesia <= 0 || timeFreeze}"
                            class="btn bg-white bg-opacity-20 p-2 rounded-lg relative">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                            </svg>
                            <span
                                class="absolute -top-1 -right-1 bg-purple-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center"
                                x-text="inventory.anesthesia"></span>
                        </button>

                        <button @click="useTimeBonusItem()" :class="{'opacity-50': inventory.timeBonus <= 0}"
                            class="btn bg-white bg-opacity-20 p-2 rounded-lg relative">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span
                                class="absolute -top-1 -right-1 bg-green-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center"
                                x-text="inventory.timeBonus"></span>
                        </button>

                        <button @click="useWordRevealItem()" :class="{'opacity-50': inventory.wordReveal <= 0}"
                            class="btn bg-white bg-opacity-20 p-2 rounded-lg relative">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <span
                                class="absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center"
                                x-text="inventory.wordReveal"></span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="flex-1 p-4 space-y-4">
                <!-- Words to find -->
                <div class="bg-white rounded-xl shadow-md p-3">
                    <h3 class="font-bold text-gray-700 mb-2">Words to Find:</h3>
                    <div class="flex flex-wrap gap-2">
                        <template x-for="(word, index) in timeWords" :key="index">
                            <div :class="{'bg-success-gradient text-white': foundWords.includes(word), 'bg-gray-100 text-gray-800': !foundWords.includes(word)}"
                                class="px-3 py-1 rounded-full text-sm font-medium" x-text="word"></div>
                        </template>
                    </div>
                </div>

                <!-- Letter grid -->
                <div class="bg-white rounded-xl shadow-md p-3">
                    <div class="grid grid-cols-10 gap-1 mb-2">
                        <template x-for="(row, rowIndex) in timeGrid" :key="rowIndex">
                            <template x-for="(cell, colIndex) in row" :key="colIndex">
                                <div :class="{
                                        'grid-cell': true,
                                        'highlighted': isHighlighted(rowIndex, colIndex),
                                        'found': isInFoundPath(rowIndex, colIndex)
                                    }" @mousedown="startWordSelection(rowIndex, colIndex)"
                                    @mouseover="continueWordSelection(rowIndex, colIndex)" @mouseup="endWordSelection()"
                                    @touchstart.prevent="startWordSelection(rowIndex, colIndex)"
                                    @touchmove.prevent="handleTouchMove($event, rowIndex, colIndex)"
                                    @touchend.prevent="endWordSelection()" x-text="cell"></div>
                            </template>
                        </template>
                    </div>
                </div>

                <!-- Current word and score -->
                <div class="flex justify-between items-center bg-white rounded-xl shadow-md p-3">
                    <div>
                        <h3 class="font-bold text-gray-700">Current Word:</h3>
                        <div class="text-lg font-medium text-blue-600" x-text="currentWord || '-'"></div>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-700">Score:</h3>
                        <div class="text-lg font-medium text-green-600" x-text="timeScore"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Progress Screen -->
        <div x-show="currentScreen === 'progress'" class="min-h-screen bg-white flex flex-col slide-in">
            <div class="bg-tertiary-gradient text-white p-6 rounded-b-3xl shadow-lg">
                <div class="flex items-center">
                    <button @click="currentScreen = 'menu'" class="mr-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                    </button>
                    <h1 class="text-2xl font-bold">Your Progress</h1>
                </div>
            </div>

            <div class="flex-1 p-6 space-y-6">
                <div class="bg-white rounded-xl shadow-lg p-4">
                    <h2 class="text-xl font-bold text-gray-800">Stats Overview</h2>

                    <div class="grid grid-cols-2 gap-4 mt-4">
                        <div class="bg-blue-50 p-3 rounded-lg">
                            <h3 class="text-sm text-blue-800 font-medium">Total Games</h3>
                            <p class="text-2xl font-bold text-blue-900" x-text="stats.totalGames"></p>
                        </div>

                        <div class="bg-green-50 p-3 rounded-lg">
                            <h3 class="text-sm text-green-800 font-medium">Words Learned</h3>
                            <p class="text-2xl font-bold text-green-900" x-text="stats.wordsLearned"></p>
                        </div>

                        <div class="bg-purple-50 p-3 rounded-lg">
                            <h3 class="text-sm text-purple-800 font-medium">Best Score</h3>
                            <p class="text-2xl font-bold text-purple-900" x-text="stats.bestScore"></p>
                        </div>

                        <div class="bg-yellow-50 p-3 rounded-lg">
                            <h3 class="text-sm text-yellow-800 font-medium">Total Coins</h3>
                            <p class="text-2xl font-bold text-yellow-900" x-text="coins"></p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-4">
                    <h2 class="text-xl font-bold text-gray-800">Recently Learned Terms</h2>

                    <div class="mt-4 space-y-3">
                        <template x-for="(term, index) in learnedTerms.slice(0, 5)" :key="index">
                            <div class="bg-gray-50 p-3 rounded-lg">
                                <div class="flex justify-between">
                                    <h3 class="font-bold text-gray-800" x-text="term.abbreviation"></h3>
                                    <span class="text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded"
                                        x-text="term.date"></span>
                                </div>
                                <p class="text-gray-600 mt-1" x-text="term.meaning"></p>
                                <p class="text-gray-500 text-sm mt-1 italic" x-text="term.description"></p>
                            </div>
                        </template>

                        <div x-show="learnedTerms.length === 0" class="text-center p-4 text-gray-500">
                            <p>No terms learned yet. Start playing to build your knowledge!</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-4">
                    <h2 class="text-xl font-bold text-gray-800">Achievement Progress</h2>

                    <div class="mt-4 space-y-3">
                        <div class="bg-gray-50 p-3 rounded-lg">
                            <h3 class="font-medium text-gray-800">Beginner Medic</h3>
                            <p class="text-sm text-gray-600 mb-2">Learn 10 medical terms</p>
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div class="bg-blue-600 h-2.5 rounded-full"
                                    :style="`width: ${Math.min(stats.wordsLearned / 10 * 100, 100)}%`"></div>
                            </div>
                        </div>

                        <div class="bg-gray-50 p-3 rounded-lg">
                            <h3 class="font-medium text-gray-800">Speed Diagnostician</h3>
                            <p class="text-sm text-gray-600 mb-2">Score 100 points in Time Mode</p>
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div class="bg-green-600 h-2.5 rounded-full"
                                    :style="`width: ${Math.min(stats.bestScore / 100 * 100, 100)}%`"></div>
                            </div>
                        </div>

                        <div class="bg-gray-50 p-3 rounded-lg">
                            <h3 class="font-medium text-gray-800">Medical Expert</h3>
                            <p class="text-sm text-gray-600 mb-2">Complete 25 games</p>
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div class="bg-purple-600 h-2.5 rounded-full"
                                    :style="`width: ${Math.min(stats.totalGames / 25 * 100, 100)}%`"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Screen -->
        <div x-show="currentScreen === 'settings'" class="min-h-screen bg-white flex flex-col slide-in">
            <div class="bg-dark-gradient text-white p-6 rounded-b-3xl shadow-lg">
                <div class="flex items-center">
                    <button @click="currentScreen = 'menu'" class="mr-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                    </button>
                    <h1 class="text-2xl font-bold">Settings</h1>
                </div>
            </div>

            <div class="flex-1 p-6 space-y-6">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <div class="bg-gray-50 p-4 border-b">
                        <h2 class="text-xl font-bold text-gray-800">Audio Settings</h2>
                    </div>

                    <div class="p-4 space-y-4">
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">Background Music</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" x-model="settings.music" class="sr-only peer"
                                    @change="toggleMusic()">
                                <div
                                    class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600">
                                </div>
                            </label>
                        </div>

                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">Sound Effects</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" x-model="settings.soundEffects" class="sr-only peer">
                                <div
                                    class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600">
                                </div>
                            </label>
                        </div>

                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">Volume</span>
                            <input type="range" min="0" max="100" x-model="settings.volume"
                                class="w-1/2 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                                @change="updateVolume()">
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <div class="bg-gray-50 p-4 border-b">
                        <h2 class="text-xl font-bold text-gray-800">Game Settings</h2>
                    </div>

                    <div class="p-4 space-y-4">
                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">Default Difficulty</span>
                            <div class="relative">
                                <div class="inline-block relative">
                                    <select x-model="settings.defaultDifficulty"
                                        class="custom-select appearance-none bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-40 p-2.5 pr-10">
                                        <option value="easy">Easy</option>
                                        <option value="medium">Medium</option>
                                        <option value="hard">Hard</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-between items-center">
                            <span class="font-medium text-gray-700">Show Hints</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" x-model="settings.showHints" class="sr-only peer">
                                <div
                                    class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600">
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                    <div class="bg-gray-50 p-4 border-b">
                        <h2 class="text-xl font-bold text-gray-800">App Settings</h2>
                    </div>

                    <div class="p-4 space-y-4">
                        <button @click="resetProgress()"
                            class="btn w-full bg-red-500 text-white font-bold py-3 px-4 rounded-xl">
                            Reset All Progress
                        </button>

                        <button @click="exportData()"
                            class="btn w-full bg-blue-500 text-white font-bold py-3 px-4 rounded-xl">
                            Export Data
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- About Screen -->
        <div x-show="currentScreen === 'about'" class="min-h-screen bg-white flex flex-col slide-in">
            <div class="bg-primary-gradient text-white p-6 rounded-b-3xl shadow-lg">
                <div class="flex items-center">
                    <button @click="currentScreen = 'menu'" class="mr-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                    </button>
                    <h1 class="text-2xl font-bold">About MedWord</h1>
                </div>
            </div>

            <div class="flex-1 p-6 space-y-6 overflow-y-auto">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex justify-center mb-4">
                        <img src="assets/images/medword-logo.png" class="w-24 h-24" alt="MedWord Logo">
                    </div>

                    <h2 class="text-2xl font-bold text-center text-gray-800">MedWord</h2>
                    <p class="text-center text-gray-600 mb-4">Version 1.0.0</p>

                    <p class="text-gray-700 mb-4">
                        MedWord is an educational game designed to help nursing and medical students
                        learn medical terminology and abbreviations in a fun and interactive way.
                    </p>

                    <h3 class="text-xl font-bold text-gray-800 mt-6 mb-3">Developed By</h3>
                    <p class="text-center text-gray-700 mb-4">
                        Game Designed by a team of Nursing Students of Mabini Colleges, Inc. - College of Nursing
                    </p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div class="bg-gray-50 rounded-lg p-3 flex items-center">
                            <img src="assets/images/villanueva.jpeg" class="w-16 h-16 rounded-full mr-3"
                                alt="Team Member">
                            <div>
                                <h4 class="font-bold text-gray-800">John Emmanuel A. Villanueva</h4>
                            </div>
                        </div>

                        <div class="bg-gray-50 rounded-lg p-3 flex items-center">
                            <img src="assets/images/ponayo.jpeg" class="w-16 h-16 rounded-full mr-3" alt="Team Member">
                            <div>
                                <h4 class="font-bold text-gray-800">Jaira Nichole L. Ponayo</h4>
                            </div>
                        </div>

                        <div class="bg-gray-50 rounded-lg p-3 flex items-center">
                            <img src="assets/images/anonuevo.jpeg" class="w-16 h-16 rounded-full mr-3"
                                alt="Team Member">
                            <div>
                                <h4 class="font-bold text-gray-800">Princess Dalia J. Aonuevo</h4>
                            </div>
                        </div>

                        <div class="bg-gray-50 rounded-lg p-3 flex items-center">
                            <img src="assets/images/gadil.jpeg" class="w-16 h-16 rounded-full mr-3" alt="Team Member">
                            <div>
                                <h4 class="font-bold text-gray-800">Arianne R. Gadil</h4>
                            </div>
                        </div>

                        <div class="bg-gray-50 rounded-lg p-3 flex items-center">
                            <img src="assets/images/rosales.jpeg" class="w-16 h-16 rounded-full mr-3" alt="Team Member">
                            <div>
                                <h4 class="font-bold text-gray-800">Nichole Rosales</h4>
                            </div>
                        </div>
                    </div>

                    <h3 class="text-xl font-bold text-gray-800 mt-6 mb-3">How to Play</h3>
                    <p class="text-gray-700 mb-2">
                        <span class="font-bold">Classic Mode:</span> Learn medical terms at your own pace. Rearrange the
                        given letters to form the correct meaning of the abbreviation.
                    </p>
                    <p class="text-gray-700 mb-4">
                        <span class="font-bold">Time Mode:</span> Find as many medical terms as possible in the letter
                        grid within the time limit. Swipe to connect letters and form words.
                    </p>

                    <h3 class="text-xl font-bold text-gray-800 mt-6 mb-3">Acknowledgements</h3>
                    <p class="text-gray-700">
                        Special thanks to the faculty of Mabini Colleges, Inc. - College of Nursing for their guidance
                        and support in the development of this educational game.
                    </p>
                </div>
            </div>
        </div>

        <!-- Result Modal -->
        <div x-show="showResultModal" class="fixed inset-0 flex items-center justify-center z-50 modal fade-in"
            @click.self="closeResultModal()">
            <div class="bg-white rounded-2xl shadow-2xl p-6 m-4 max-w-sm w-full" @click.stop>
                <div class="text-center">
                    <div x-show="isCorrect" class="mx-auto mb-4">
                        <div
                            class="w-20 h-20 bg-success-gradient rounded-full flex items-center justify-center mx-auto">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-white" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M5 13l4 4L19 7" />
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-green-600 mt-2">Correct!</h2>
                    </div>

                    <div x-show="!isCorrect" class="mx-auto mb-4">
                        <div class="w-20 h-20 bg-danger-gradient rounded-full flex items-center justify-center mx-auto">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-white" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-red-600 mt-2">Incorrect!</h2>
                    </div>

                    <div class="my-4">
                        <h3 class="font-bold text-gray-700" x-text="currentClassicQuestion?.abbreviation"></h3>
                        <p class="text-xl font-bold text-blue-600 mt-1" x-text="currentClassicQuestion?.meaning"></p>
                        <p class="text-gray-600 text-sm mt-2" x-text="currentClassicQuestion?.description"></p>
                    </div>

                    <div x-show="isCorrect" class="bg-green-50 p-3 rounded-lg flex items-center justify-between mb-4">
                        <span class="text-green-800 font-medium">Coins earned:</span>
                        <div class="flex items-center">
                            <img src="assets/images/coin.png" class="w-5 h-5 coin mr-2" alt="Coins">
                            <span class="font-bold text-green-800" x-text="earnedCoins"></span>
                        </div>
                    </div>

                    <button @click="nextQuestion()"
                        class="btn w-full bg-primary-gradient text-white font-bold py-3 rounded-xl mt-2">
                        Continue
                    </button>
                </div>
            </div>
        </div>

        <!-- Time Mode Results Modal -->
        <div x-show="showTimeResultModal" class="fixed inset-0 flex items-center justify-center z-50 modal fade-in">
            <div class="bg-white rounded-2xl shadow-2xl p-6 m-4 max-w-sm w-full">
                <div class="text-center">
                    <div class="mx-auto mb-4">
                        <div
                            class="w-20 h-20 bg-primary-gradient rounded-full flex items-center justify-center mx-auto">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-white" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800 mt-2">Time's Up!</h2>
                    </div>

                    <div class="my-4 space-y-3">
                        <div class="bg-blue-50 p-3 rounded-lg flex items-center justify-between">
                            <span class="text-blue-800 font-medium">Words Found:</span>
                            <span class="font-bold text-blue-800"
                                x-text="`${foundWords.length}/${timeWords.length}`"></span>
                        </div>

                        <div class="bg-purple-50 p-3 rounded-lg flex items-center justify-between">
                            <span class="text-purple-800 font-medium">Final Score:</span>
                            <span class="font-bold text-purple-800" x-text="timeScore"></span>
                        </div>

                        <div class="bg-green-50 p-3 rounded-lg flex items-center justify-between">
                            <span class="text-green-800 font-medium">Coins earned:</span>
                            <div class="flex items-center">
                                <img src="assets/images/coin.png" class="w-5 h-5 coin mr-2" alt="Coins">
                                <span class="font-bold text-green-800" x-text="earnedCoins"></span>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 space-y-3">
                        <button @click="restartTimeMode()"
                            class="btn w-full bg-secondary-gradient text-white font-bold py-3 rounded-xl">
                            Play Again
                        </button>

                        <button @click="showTimeResultModal = false; currentScreen = 'menu'"
                            class="btn w-full bg-gray-200 text-gray-800 font-bold py-3 rounded-xl">
                            Back to Menu
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Purchase Success Modal -->
        <div x-show="showPurchaseModal" class="fixed inset-0 flex items-center justify-center z-50 modal fade-in"
            @click.self="showPurchaseModal = false">
            <div class="bg-white rounded-2xl shadow-2xl p-6 m-4 max-w-sm w-full bounce" @click.stop>
                <div class="text-center">
                    <div class="mx-auto mb-4">
                        <div
                            class="w-20 h-20 bg-success-gradient rounded-full flex items-center justify-center mx-auto">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-white" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M5 13l4 4L19 7" />
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-green-600 mt-2">Purchase Successful!</h2>
                    </div>

                    <div class="my-4">
                        <p class="text-gray-600" x-text="purchaseMessage"></p>
                    </div>

                    <div class="bg-blue-50 p-3 rounded-lg flex items-center justify-between mb-4">
                        <span class="text-blue-800 font-medium">Remaining Coins:</span>
                        <div class="flex items-center">
                            <img src="assets/images/coin.png" class="w-5 h-5 coin mr-2" alt="Coins">
                            <span class="font-bold text-blue-800" x-text="coins"></span>
                        </div>
                    </div>

                    <button @click="showPurchaseModal = false"
                        class="btn w-full bg-primary-gradient text-white font-bold py-3 rounded-xl mt-2">
                        Continue Shopping
                    </button>
                </div>
            </div>
        </div>

        <!-- Quit Confirmation Modal -->
        <div x-show="confirmQuit" class="fixed inset-0 flex items-center justify-center z-50 modal fade-in"
            @click.self="confirmQuit = false">
            <div class="bg-white rounded-2xl shadow-2xl p-6 m-4 max-w-sm w-full" @click.stop>
                <div class="text-center">
                    <div class="mx-auto mb-4">
                        <div class="w-20 h-20 bg-yellow-100 rounded-full flex items-center justify-center mx-auto">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-yellow-500" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800 mt-2">Quit Game?</h2>
                    </div>

                    <p class="text-gray-600 mb-6">Are you sure you want to quit? Your current game progress will be
                        lost.</p>

                    <div class="flex space-x-3">
                        <button @click="confirmQuit = false"
                            class="btn flex-1 bg-gray-200 text-gray-800 font-bold py-3 rounded-xl">
                            Cancel
                        </button>

                        <button @click="quitGame()"
                            class="btn flex-1 bg-danger-gradient text-white font-bold py-3 rounded-xl">
                            Quit
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function gameApp() {
            return {
                // App state
                currentScreen: 'splash',
                splashProgress: 0,
                confirmQuit: false,
                shopCategory: 'powerups',
                showPurchaseModal: false,
                purchaseMessage: '',

                // Game settings
                settings: {
                    music: true,
                    soundEffects: true,
                    volume: 70,
                    defaultDifficulty: 'medium',
                    showHints: true
                },

                // Player data
                coins: 0,
                claimedFreeCoins: false,
                dailyProgress: 0,
                stats: {
                    totalGames: 0,
                    wordsLearned: 0,
                    bestScore: 0
                },
                learnedTerms: [],
                inventory: {
                    anesthesia: 0,
                    hints: 0,
                    timeBonus: 0,
                    wordReveal: 0,
                    unlockedPacks: [],
                    activeTheme: 'default',
                    ownedThemes: []
                },

                // Game mode settings
                difficulty: 'medium',

                // Classic mode variables
                classicQuestions: [],
                currentQuestionIndex: 0,
                currentClassicQuestion: null,
                shuffledLetters: [],
                selectedLetterIndices: [],
                answerArray: [],
                classicScore: 0,

                // Time mode variables
                timeWords: [],
                timeGrid: [],
                timeRemaining: 120, // 2 minutes
                timerInterval: null,
                currentWord: '',
                selectedCells: [],
                foundWords: [],
                timeScore: 0,
                timeFreeze: false,
                freezeTimeout: null,
                isSelecting: false,

                // Modals
                showResultModal: false,
                isCorrect: false,
                earnedCoins: 0,
                showTimeResultModal: false,

                // Random tips
                tips: [
                    "TID stands for 'ter in die' which means 'three times a day' in Latin.",
                    "Medical abbreviations often come from Latin or Greek origins.",
                    "Use the hint button if you're stuck on a difficult term.",
                    "In Time Mode, words can be found horizontally, vertically, and diagonally.",
                    "Learning medical terminology improves your communication in healthcare settings.",
                    "Some abbreviations have multiple meanings, context matters!",
                    "PRN means 'pro re nata' or 'as needed' in prescriptions.",
                    "Time Mode is great for improving your visual word recognition skills.",
                    "Use anesthesia power-up to freeze the timer in Time Mode.",
                    "The easier the difficulty, the more common the terms will be.",
                    "Visit the shop to purchase power-ups and term packs!",
                    "Collect coins by answering correctly and finding all words in Time Mode."
                ],
                randomTip: '',

                // Medical terms database
                medicalTerms: {
                    easy: [
                        { abbreviation: "TID", meaning: "Three times a day", description: "TID (ter in die) is used in prescriptions to indicate that a medication should be taken three times a day.", hint: "Frequency of medication administration" },
                        { abbreviation: "BID", meaning: "Twice a day", description: "BID (bis in die) indicates that a medication should be taken twice daily.", hint: "Frequency of medication administration" },
                        { abbreviation: "PRN", meaning: "As needed", description: "PRN (pro re nata) means a medication should be taken only when necessary.", hint: "Conditional medication instruction" },
                        { abbreviation: "NPO", meaning: "Nothing by mouth", description: "NPO (nil per os) is an instruction to withhold oral food and fluids.", hint: "Fasting instruction before procedures" },
                        { abbreviation: "IV", meaning: "Intravenous", description: "IV refers to administration of fluids or medications directly into a vein.", hint: "Route of medication administration" },
                        { abbreviation: "PO", meaning: "By mouth", description: "PO (per os) refers to oral administration of medication.", hint: "Route of medication administration" },
                        { abbreviation: "Rx", meaning: "Prescription", description: "Rx is used to denote a medical prescription.", hint: "Symbol seen on medication orders" },
                        { abbreviation: "BP", meaning: "Blood pressure", description: "BP is a vital sign measuring the pressure of circulating blood on vessel walls.", hint: "Important vital sign" },
                        { abbreviation: "HR", meaning: "Heart rate", description: "HR measures the number of heartbeats per minute.", hint: "Cardiac vital sign" },
                        { abbreviation: "Temp", meaning: "Temperature", description: "Body temperature is a vital sign indicating heat level in the body.", hint: "Measured with a thermometer" }
                    ],
                    medium: [
                        { abbreviation: "SOB", meaning: "Shortness of breath", description: "SOB describes difficulty breathing or dyspnea.", hint: "Respiratory symptom" },
                        { abbreviation: "COPD", meaning: "Chronic obstructive pulmonary disease", description: "COPD is a progressive lung disease that causes breathing difficulty.", hint: "Respiratory condition" },
                        { abbreviation: "MI", meaning: "Myocardial infarction", description: "MI is the medical term for a heart attack.", hint: "Cardiac emergency" },
                        { abbreviation: "CVA", meaning: "Cerebrovascular accident", description: "CVA is the medical term for a stroke.", hint: "Neurological emergency" },
                        { abbreviation: "HTN", meaning: "Hypertension", description: "HTN refers to chronically elevated blood pressure.", hint: "Cardiovascular condition" },
                        { abbreviation: "DM", meaning: "Diabetes mellitus", description: "DM is a metabolic disorder affecting blood glucose regulation.", hint: "Endocrine disorder" },
                        { abbreviation: "GERD", meaning: "Gastroesophageal reflux disease", description: "GERD is a digestive disorder affecting the lower esophageal sphincter.", hint: "Digestive condition" },
                        { abbreviation: "UTI", meaning: "Urinary tract infection", description: "UTI is an infection in any part of the urinary system.", hint: "Common infection" },
                        { abbreviation: "ROM", meaning: "Range of motion", description: "ROM refers to the measurement of movement around a specific joint.", hint: "Physical assessment term" },
                        { abbreviation: "STAT", meaning: "Immediately", description: "STAT (statim) indicates that action should be taken without delay.", hint: "Urgent timeframe" }
                    ],
                    hard: [
                        { abbreviation: "CABG", meaning: "Coronary artery bypass graft", description: "CABG is a surgical procedure to restore blood flow to the heart.", hint: "Cardiac surgery" },
                        { abbreviation: "ARDS", meaning: "Acute respiratory distress syndrome", description: "ARDS is a serious lung condition causing fluid buildup and breathing difficulty.", hint: "Critical respiratory condition" },
                        { abbreviation: "ESRD", meaning: "End stage renal disease", description: "ESRD is the final stage of chronic kidney disease requiring dialysis or transplant.", hint: "Kidney failure" },
                        { abbreviation: "DVT", meaning: "Deep vein thrombosis", description: "DVT is a blood clot that forms in a deep vein, usually in the legs.", hint: "Vascular condition" },
                        { abbreviation: "TPN", meaning: "Total parenteral nutrition", description: "TPN is intravenous feeding that bypasses the digestive system.", hint: "Nutritional support" },
                        { abbreviation: "SLE", meaning: "Systemic lupus erythematosus", description: "SLE is an autoimmune disease affecting multiple body systems.", hint: "Autoimmune condition" },
                        { abbreviation: "PTSD", meaning: "Post traumatic stress disorder", description: "PTSD is a mental health condition triggered by experiencing traumatic events.", hint: "Psychological condition" },
                        { abbreviation: "NASH", meaning: "Nonalcoholic steatohepatitis", description: "NASH is liver inflammation and damage caused by fat buildup not related to alcohol.", hint: "Liver condition" },
                        { abbreviation: "SIADH", meaning: "Syndrome of inappropriate antidiuretic hormone", description: "SIADH is a condition where the body makes too much antidiuretic hormone.", hint: "Endocrine disorder" },
                        { abbreviation: "ECMO", meaning: "Extracorporeal membrane oxygenation", description: "ECMO is a life support technique for patients with severe heart or lung failure.", hint: "Advanced life support" }
                    ],
                    cardiology: [
                        { abbreviation: "AF", meaning: "Atrial fibrillation", description: "AF is an irregular heart rhythm characterized by rapid and irregular beating of the atria.", hint: "Cardiac arrhythmia" },
                        { abbreviation: "CAD", meaning: "Coronary artery disease", description: "CAD involves the narrowing or blockage of the coronary arteries.", hint: "Heart blood vessel condition" },
                        { abbreviation: "CHF", meaning: "Congestive heart failure", description: "CHF occurs when the heart can't pump blood efficiently to meet the body's needs.", hint: "Cardiac pump disorder" }
                    ],
                    neurology: [
                        { abbreviation: "TBI", meaning: "Traumatic brain injury", description: "TBI is a disruption in normal brain function caused by a blow or jolt to the head.", hint: "Head trauma" },
                        { abbreviation: "MS", meaning: "Multiple sclerosis", description: "MS is a disease in which the immune system eats away at the protective covering of nerves.", hint: "Autoimmune neurological disorder" },
                        { abbreviation: "PD", meaning: "Parkinson disease", description: "PD is a progressive nervous system disorder affecting movement.", hint: "Movement disorder" }
                    ],
                    pharmacology: [
                        { abbreviation: "ACE", meaning: "Angiotensin converting enzyme", description: "ACE inhibitors are medications used to treat high blood pressure and heart failure.", hint: "Blood pressure medication" },
                        { abbreviation: "NSAID", meaning: "Nonsteroidal anti inflammatory drug", description: "NSAIDs reduce pain, decrease fever, and prevent blood clots.", hint: "Pain and inflammation medication" },
                        { abbreviation: "SSRI", meaning: "Selective serotonin reuptake inhibitor", description: "SSRIs are a class of drugs typically used as antidepressants.", hint: "Psychiatric medication" }
                    ]
                },

                // Word search words for time mode
                wordSearchWords: {
                    easy: ["FEVER", "PULSE", "BLOOD", "HEART", "WOUND", "NURSE", "VITAL", "DOSE", "PAIN", "ORAL"],
                    medium: ["THERAPY", "INSULIN", "SWELLING", "FRACTURE", "CARDIAC", "CHRONIC", "LESION", "EDEMA", "TRAUMA", "BIOPSY"],
                    hard: ["DIAGNOSIS", "PALLIATIVE", "ONCOLOGY", "HEMATOMA", "ISCHEMIA", "SYNDROME", "VENTILATOR", "PATHOGEN", "PNEUMONIA", "DIALYSIS"],
                    cardiology: ["STENT", "BYPASS", "VALVE", "MURMUR", "THROMBUS", "ANGINA", "RHYTHM"],
                    neurology: ["SEIZURE", "REFLEX", "NERVE", "SPINAL", "TREMOR", "MEMORY", "STROKE"],
                    pharmacology: ["DOSAGE", "TABLET", "INFUSION", "TOPICAL", "ADVERSE", "DILUENT", "SEDATIVE"]
                },

                init() {
                    this.loadData();
                    this.randomTip = this.tips[Math.floor(Math.random() * this.tips.length)];

                    // Simulate loading progress
                    const loadingInterval = setInterval(() => {
                        this.splashProgress += 2;
                        if (this.splashProgress >= 100) {
                            clearInterval(loadingInterval);
                        }
                    }, 50);
                },

                loadData() {
                    // Load saved data from localStorage
                    const savedData = localStorage.getItem('medwordData');
                    if (savedData) {
                        const data = JSON.parse(savedData);
                        this.coins = data.coins || 0;
                        this.claimedFreeCoins = data.claimedFreeCoins || false;
                        this.dailyProgress = data.dailyProgress || 0;
                        this.stats = data.stats || { totalGames: 0, wordsLearned: 0, bestScore: 0 };
                        this.learnedTerms = data.learnedTerms || [];
                        this.settings = data.settings || this.settings;
                        this.inventory = data.inventory || this.inventory;
                    }
                },

                saveData() {
                    const dataToSave = {
                        coins: this.coins,
                        claimedFreeCoins: this.claimedFreeCoins,
                        dailyProgress: this.dailyProgress,
                        stats: this.stats,
                        learnedTerms: this.learnedTerms,
                        settings: this.settings,
                        inventory: this.inventory
                    };
                    localStorage.setItem('medwordData', JSON.stringify(dataToSave));
                },

                startGame() {
                    if (this.settings.music) {
                        const bgMusic = document.getElementById('bgMusic');
                        bgMusic.volume = this.settings.volume / 100;
                        bgMusic.play().catch(e => console.log('Audio autoplay was prevented.'));
                    }
                    this.currentScreen = 'menu';
                },

                toggleMusic() {
                    const bgMusic = document.getElementById('bgMusic');
                    if (this.settings.music) {
                        bgMusic.play().catch(e => console.log('Audio autoplay was prevented.'));
                    } else {
                        bgMusic.pause();
                    }
                    this.saveData();
                },

                updateVolume() {
                    const bgMusic = document.getElementById('bgMusic');
                    bgMusic.volume = this.settings.volume / 100;
                    this.saveData();
                },

                playSound(sound) {
                    if (!this.settings.soundEffects) return;

                    const audio = document.getElementById(sound);
                    audio.volume = this.settings.volume / 100;
                    audio.currentTime = 0;
                    audio.play().catch(e => console.log('Audio play was prevented.'));
                },

                showGameMode() {
                    this.difficulty = this.settings.defaultDifficulty;
                    this.currentScreen = 'gameMode';
                },

                setDifficulty(level) {
                    this.difficulty = level;
                },

                // Theme management
                themeOwned(theme) {
                    return theme === 'default' || this.inventory.activeTheme === theme || this.inventory.ownedThemes.includes(theme);
                },

                activateTheme(theme) {
                    if (theme === 'default' || this.themeOwned(theme)) {
                        this.inventory.activeTheme = theme;
                        this.saveData();
                    }
                },

                startClassicMode() {
                    // Initialize classic mode game
                    this.classicQuestions = [...this.medicalTerms[this.difficulty]];

                    // Add specialty packs if unlocked
                    if (this.inventory.unlockedPacks.includes('cardiologyPack') || this.inventory.unlockedPacks.includes('premiumBundle')) {
                        this.classicQuestions = this.classicQuestions.concat(this.medicalTerms.cardiology);
                    }
                    if (this.inventory.unlockedPacks.includes('neurologyPack') || this.inventory.unlockedPacks.includes('premiumBundle')) {
                        this.classicQuestions = this.classicQuestions.concat(this.medicalTerms.neurology);
                    }
                    if (this.inventory.unlockedPacks.includes('pharmacologyPack') || this.inventory.unlockedPacks.includes('premiumBundle')) {
                        this.classicQuestions = this.classicQuestions.concat(this.medicalTerms.pharmacology);
                    }

                    this.shuffleArray(this.classicQuestions);
                    this.currentQuestionIndex = 0;
                    this.classicScore = 0;
                    this.loadQuestion();
                    this.currentScreen = 'classicMode';
                    this.stats.totalGames++;
                    this.saveData();
                },

                startTimeMode() {
                    // Initialize time mode game
                    this.timeWords = [...this.wordSearchWords[this.difficulty]];

                    // Add specialty packs if unlocked
                    if (this.inventory.unlockedPacks.includes('cardiologyPack') || this.inventory.unlockedPacks.includes('premiumBundle')) {
                        this.timeWords = this.timeWords.concat(this.wordSearchWords.cardiology);
                    }
                    if (this.inventory.unlockedPacks.includes('neurologyPack') || this.inventory.unlockedPacks.includes('premiumBundle')) {
                        this.timeWords = this.timeWords.concat(this.wordSearchWords.neurology);
                    }
                    if (this.inventory.unlockedPacks.includes('pharmacologyPack') || this.inventory.unlockedPacks.includes('premiumBundle')) {
                        this.timeWords = this.timeWords.concat(this.wordSearchWords.pharmacology);
                    }

                    this.shuffleArray(this.timeWords);
                    this.timeWords = this.timeWords.slice(0, 7); // Limit to 7 words for difficulty
                    this.generateWordSearchGrid();

                    this.timeRemaining = 120; // 2 minutes
                    this.foundWords = [];
                    this.timeScore = 0;
                    this.timeFreeze = false;
                    this.currentScreen = 'timeMode';

                    // Start the timer
                    clearInterval(this.timerInterval);
                    this.timerInterval = setInterval(() => {
                        if (!this.timeFreeze) {
                            this.timeRemaining--;
                        }

                        if (this.timeRemaining <= 0) {
                            clearInterval(this.timerInterval);
                            this.endTimeMode();
                        }
                    }, 1000);

                    this.stats.totalGames++;
                    this.saveData();
                },

                restartTimeMode() {
                    this.showTimeResultModal = false;
                    this.startTimeMode();
                },

                loadQuestion() {
                    this.currentClassicQuestion = this.classicQuestions[this.currentQuestionIndex];

                    // Create shuffled letters for the game
                    const meaning = this.currentClassicQuestion.meaning.toUpperCase().replace(/[^A-Z ]/g, '');

                    // Initialize answer array with spaces for letters and preserve spaces from the original word
                    this.answerArray = meaning.split('').map(char => char === ' ' ? ' ' : ' ');

                    // Create letter tiles only for non-space characters
                    const letters = meaning.replace(/\s/g, '').split('');
                    this.shuffledLetters = [...letters];

                    // Add some additional random letters as distractors
                    const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                    const extraLettersCount = Math.min(3, 10 - letters.length); // Ensure we don't exceed 10 letters total

                    for (let i = 0; i < extraLettersCount; i++) {
                        const randomLetter = alphabet[Math.floor(Math.random() * alphabet.length)];
                        this.shuffledLetters.push(randomLetter);
                    }

                    this.shuffleArray(this.shuffledLetters);
                    this.selectedLetterIndices = [];
                },

                selectLetter(index) {
                    const letter = this.shuffledLetters[index];
                    if (letter === ' ') return; // Skip if letter is already used

                    // Find the first empty spot in the answer (that's not a space character)
                    const emptyIndex = this.answerArray.findIndex((l, idx) => l === ' ' && this.currentClassicQuestion.meaning.toUpperCase().charAt(idx) !== ' ');

                    if (emptyIndex !== -1) {
                        // Update answer array and mark letter as selected
                        this.answerArray[emptyIndex] = letter;
                        this.selectedLetterIndices.push(index);
                        this.shuffledLetters[index] = ' '; // Mark as used

                        this.playSound('correctSound');
                    }
                },

                removeLetter(index) {
                    // Skip if this is a space or an empty tile
                    if (this.answerArray[index] === ' ') return;

                    // Get the letter that needs to be returned to shuffled letters
                    const letterToReturn = this.answerArray[index];

                    // Find an empty slot in shuffled letters
                    const emptySlotIndex = this.shuffledLetters.findIndex(l => l === ' ');

                    if (emptySlotIndex !== -1) {
                        // Return the letter to shuffled letters
                        this.shuffledLetters[emptySlotIndex] = letterToReturn;

                        // Remove the letter from answer array
                        this.answerArray[index] = ' ';

                        // Find and remove the corresponding index from selectedLetterIndices
                        const selectedIndex = this.selectedLetterIndices.find(idx =>
                            this.shuffledLetters[idx] === ' ' &&
                            this.selectedLetterIndices.indexOf(idx) === this.selectedLetterIndices.length - 1
                        );

                        if (selectedIndex !== undefined) {
                            const indexToRemove = this.selectedLetterIndices.indexOf(selectedIndex);
                            if (indexToRemove !== -1) {
                                this.selectedLetterIndices.splice(indexToRemove, 1);
                            }
                        }

                        // Play sound effect
                        this.playSound('correctSound');
                    }
                },

                clearAnswer() {
                    // Get the original meaning with spaces
                    const meaning = this.currentClassicQuestion.meaning.toUpperCase().replace(/[^A-Z ]/g, '');

                    // Restore all selected letters
                    this.selectedLetterIndices.forEach((letterIndex, i) => {
                        const answerIndex = this.answerArray.findIndex((l, idx) => l !== ' ' && meaning.charAt(idx) !== ' ');
                        if (answerIndex !== -1) {
                            this.shuffledLetters[letterIndex] = this.answerArray[answerIndex];
                            this.answerArray[answerIndex] = ' ';
                        }
                    });

                    // Reset selected indices
                    this.selectedLetterIndices = [];

                    // Reset answer array with spaces where they belong
                    this.answerArray = meaning.split('').map((char) => char === ' ' ? ' ' : ' ');
                },

                submitAnswer() {
                    const submittedAnswer = this.answerArray.join('');
                    const correctAnswer = this.currentClassicQuestion.meaning.toUpperCase().replace(/[^A-Z ]/g, '');

                    this.isCorrect = submittedAnswer === correctAnswer;

                    if (this.isCorrect) {
                        this.classicScore += 10;
                        this.earnedCoins = 5;
                        this.coins += this.earnedCoins;
                        this.playSound('coinSound');

                        // Add to learned terms
                        const alreadyLearned = this.learnedTerms.some(term => term.abbreviation === this.currentClassicQuestion.abbreviation);
                        if (!alreadyLearned) {
                            this.learnedTerms.unshift({
                                abbreviation: this.currentClassicQuestion.abbreviation,
                                meaning: this.currentClassicQuestion.meaning,
                                description: this.currentClassicQuestion.description,
                                date: new Date().toLocaleDateString()
                            });
                            this.stats.wordsLearned++;
                        }
                    } else {
                        this.playSound('wrongSound');
                    }

                    this.showResultModal = true;
                    this.saveData();
                },

                nextQuestion() {
                    this.showResultModal = false;
                    this.currentQuestionIndex++;

                    if (this.currentQuestionIndex >= this.classicQuestions.length) {
                        // End of game
                        this.dailyProgress++;
                        this.currentScreen = 'menu';
                        return;
                    }

                    this.loadQuestion();
                },

                closeResultModal() {
                    this.showResultModal = false;
                },

                useHint() {
                    if (this.coins < 10) return;

                    this.coins -= 10;

                    // Reveal a random letter in the answer
                    const correctAnswer = this.currentClassicQuestion.meaning.toUpperCase().replace(/[^A-Z ]/g, '');
                    const answerLetters = correctAnswer.split('');

                    // Find positions that don't match yet
                    const unmatchedPositions = [];
                    for (let i = 0; i < answerLetters.length; i++) {
                        if (answerLetters[i] !== ' ' && this.answerArray[i] !== answerLetters[i]) {
                            unmatchedPositions.push(i);
                        }
                    }

                    if (unmatchedPositions.length > 0) {
                        // Randomly select one position to reveal
                        const hintIndex = unmatchedPositions[Math.floor(Math.random() * unmatchedPositions.length)];

                        // Find the letter in shuffled letters
                        const letterToReveal = answerLetters[hintIndex];
                        const shuffledIndex = this.shuffledLetters.findIndex(l => l === letterToReveal);

                        if (shuffledIndex !== -1) {
                            // Select this letter
                            this.selectLetter(shuffledIndex);
                        }
                    }

                    this.playSound('correctSound');
                    this.saveData();
                },

                useHintItem() {
                    if (this.inventory.hints <= 0) return;

                    this.inventory.hints--;

                    // Reveal a random letter in the answer
                    const correctAnswer = this.currentClassicQuestion.meaning.toUpperCase().replace(/[^A-Z ]/g, '');
                    const answerLetters = correctAnswer.split('');

                    // Find positions that don't match yet
                    const unmatchedPositions = [];
                    for (let i = 0; i < answerLetters.length; i++) {
                        if (answerLetters[i] !== ' ' && this.answerArray[i] !== answerLetters[i]) {
                            unmatchedPositions.push(i);
                        }
                    }

                    if (unmatchedPositions.length > 0) {
                        // Randomly select one position to reveal
                        const hintIndex = unmatchedPositions[Math.floor(Math.random() * unmatchedPositions.length)];

                        // Find the letter in shuffled letters
                        const letterToReveal = answerLetters[hintIndex];
                        const shuffledIndex = this.shuffledLetters.findIndex(l => l === letterToReveal);

                        if (shuffledIndex !== -1) {
                            // Select this letter
                            this.selectLetter(shuffledIndex);
                        }
                    }

                    this.playSound('correctSound');
                    this.saveData();
                },

                useAnesthesia() {
                    if (this.coins < 20 || this.timeFreeze) return;

                    this.coins -= 20;
                    this.timeFreeze = true;

                    // Freeze the timer for 10 seconds
                    clearTimeout(this.freezeTimeout);
                    this.freezeTimeout = setTimeout(() => {
                        this.timeFreeze = false;
                    }, 10000);

                    this.playSound('correctSound');
                    this.saveData();
                },

                useAnesthesiaItem() {
                    if (this.inventory.anesthesia <= 0 || this.timeFreeze) return;

                    this.inventory.anesthesia--;
                    this.timeFreeze = true;

                    // Freeze the timer for 10 seconds
                    clearTimeout(this.freezeTimeout);
                    this.freezeTimeout = setTimeout(() => {
                        this.timeFreeze = false;
                    }, 10000);

                    this.playSound('correctSound');
                    this.saveData();
                },

                useTimeBonusItem() {
                    if (this.inventory.timeBonus <= 0) return;

                    this.inventory.timeBonus--;
                    this.timeRemaining += 30; // Add 30 seconds

                    this.playSound('correctSound');
                    this.saveData();
                },

                useWordRevealItem() {
                    if (this.inventory.wordReveal <= 0) return;

                    // Find a word that hasn't been found yet
                    const unFoundWords = this.timeWords.filter(word => !this.foundWords.includes(word));

                    if (unFoundWords.length > 0) {
                        const word = unFoundWords[0];
                        this.foundWords.push(word);
                        this.timeScore += word.length * 5;
                        this.inventory.wordReveal--;

                        this.playSound('correctSound');
                        this.saveData();

                        // Check if all words are found
                        if (this.foundWords.length === this.timeWords.length) {
                            // Apply bonus for finding all words
                            this.timeScore += 50;
                            setTimeout(() => {
                                this.endTimeMode();
                            }, 1000);
                        }
                    }
                },

                buyItem(itemId) {
                    let cost = 0;
                    let message = '';

                    switch (itemId) {
                        case 'anesthesiaPack':
                            if (this.coins < 100) return;
                            cost = 100;
                            this.inventory.anesthesia += 5;
                            message = 'You purchased 5 Anesthesia power-ups!';
                            break;
                        case 'hintPack':
                            if (this.coins < 80) return;
                            cost = 80;
                            this.inventory.hints += 10;
                            message = 'You purchased 10 Hints!';
                            break;
                        case 'timeBonus':
                            if (this.coins < 60) return;
                            cost = 60;
                            this.inventory.timeBonus += 3;
                            message = 'You purchased 3 Time Bonus power-ups!';
                            break;
                        case 'wordReveal':
                            if (this.coins < 120) return;
                            cost = 120;
                            this.inventory.wordReveal += 2;
                            message = 'You purchased 2 Word Reveal power-ups!';
                            break;
                        case 'cardiologyPack':
                            if (this.coins < 150) return;
                            cost = 150;
                            if (!this.inventory.unlockedPacks.includes('cardiologyPack')) {
                                this.inventory.unlockedPacks.push('cardiologyPack');
                            }
                            message = 'You unlocked the Cardiology term pack!';
                            break;
                        case 'neurologyPack':
                            if (this.coins < 150) return;
                            cost = 150;
                            if (!this.inventory.unlockedPacks.includes('neurologyPack')) {
                                this.inventory.unlockedPacks.push('neurologyPack');
                            }
                            message = 'You unlocked the Neurology term pack!';
                            break;
                        case 'pharmacologyPack':
                            if (this.coins < 150) return;
                            cost = 150;
                            if (!this.inventory.unlockedPacks.includes('pharmacologyPack')) {
                                this.inventory.unlockedPacks.push('pharmacologyPack');
                            }
                            message = 'You unlocked the Pharmacology term pack!';
                            break;
                        case 'premiumBundle':
                            if (this.coins < 400) return;
                            cost = 400;
                            if (!this.inventory.unlockedPacks.includes('cardiologyPack')) {
                                this.inventory.unlockedPacks.push('cardiologyPack');
                            }
                            if (!this.inventory.unlockedPacks.includes('neurologyPack')) {
                                this.inventory.unlockedPacks.push('neurologyPack');
                            }
                            if (!this.inventory.unlockedPacks.includes('pharmacologyPack')) {
                                this.inventory.unlockedPacks.push('pharmacologyPack');
                            }
                            if (!this.inventory.unlockedPacks.includes('premiumBundle')) {
                                this.inventory.unlockedPacks.push('premiumBundle');
                            }
                            message = 'You unlocked the Premium Bundle with all specialty term packs!';
                            break;
                        case 'oceanTheme':
                            if (this.coins < 100) return;
                            cost = 100;
                            if (!this.inventory.ownedThemes.includes('ocean')) {
                                this.inventory.ownedThemes.push('ocean');
                            }
                            this.inventory.activeTheme = 'ocean';
                            message = 'Ocean Theme purchased and activated!';
                            break;
                        case 'sunsetTheme':
                            if (this.coins < 100) return;
                            cost = 100;
                            if (!this.inventory.ownedThemes.includes('sunset')) {
                                this.inventory.ownedThemes.push('sunset');
                            }
                            this.inventory.activeTheme = 'sunset';
                            message = 'Sunset Theme purchased and activated!';
                            break;
                        case 'forestTheme':
                            if (this.coins < 100) return;
                            cost = 100;
                            if (!this.inventory.ownedThemes.includes('forest')) {
                                this.inventory.ownedThemes.push('forest');
                            }
                            this.inventory.activeTheme = 'forest';
                            message = 'Forest Theme purchased and activated!';
                            break;
                    }

                    // Process purchase
                    this.coins -= cost;
                    this.purchaseMessage = message;
                    this.showPurchaseModal = true;
                    this.playSound('purchaseSound');
                    this.saveData();
                },

                generateWordSearchGrid() {
                    // Create a 10x10 grid filled with spaces
                    this.timeGrid = Array(10).fill().map(() => Array(10).fill(' '));

                    // Place each word in the grid
                    for (const word of this.timeWords) {
                        let placed = false;
                        let attempts = 0;

                        while (!placed && attempts < 100) {
                            attempts++;

                            // Randomly choose orientation (0: horizontal, 1: vertical, 2: diagonal down, 3: diagonal up)
                            const orientation = Math.floor(Math.random() * 4);

                            // Randomly choose starting position
                            let row, col;

                            if (orientation === 0) { // Horizontal
                                row = Math.floor(Math.random() * 10);
                                col = Math.floor(Math.random() * (11 - word.length));
                            } else if (orientation === 1) { // Vertical
                                row = Math.floor(Math.random() * (11 - word.length));
                                col = Math.floor(Math.random() * 10);
                            } else if (orientation === 2) { // Diagonal down
                                row = Math.floor(Math.random() * (11 - word.length));
                                col = Math.floor(Math.random() * (11 - word.length));
                            } else { // Diagonal up
                                row = Math.floor(Math.random() * (11 - word.length)) + word.length - 1;
                                col = Math.floor(Math.random() * (11 - word.length));
                            }

                            // Check if word fits at the chosen position
                            let fits = true;
                            for (let i = 0; i < word.length; i++) {
                                let r, c;

                                if (orientation === 0) { // Horizontal
                                    r = row;
                                    c = col + i;
                                } else if (orientation === 1) { // Vertical
                                    r = row + i;
                                    c = col;
                                } else if (orientation === 2) { // Diagonal down
                                    r = row + i;
                                    c = col + i;
                                } else { // Diagonal up
                                    r = row - i;
                                    c = col + i;
                                }

                                if (this.timeGrid[r][c] !== ' ' && this.timeGrid[r][c] !== word[i]) {
                                    fits = false;
                                    break;
                                }
                            }

                            // Place the word if it fits
                            if (fits) {
                                for (let i = 0; i < word.length; i++) {
                                    let r, c;

                                    if (orientation === 0) { // Horizontal
                                        r = row;
                                        c = col + i;
                                    } else if (orientation === 1) { // Vertical
                                        r = row + i;
                                        c = col;
                                    } else if (orientation === 2) { // Diagonal down
                                        r = row + i;
                                        c = col + i;
                                    } else { // Diagonal up
                                        r = row - i;
                                        c = col + i;
                                    }

                                    this.timeGrid[r][c] = word[i];
                                }
                                placed = true;
                            }
                        }

                        // If we couldn't place the word after many attempts, try a different word
                        if (!placed) {
                            console.log(`Could not place word: ${word}`);
                        }
                    }

                    // Fill remaining spaces with random letters
                    for (let i = 0; i < 10; i++) {
                        for (let j = 0; j < 10; j++) {
                            if (this.timeGrid[i][j] === ' ') {
                                const randomLetter = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'[Math.floor(Math.random() * 26)];
                                this.timeGrid[i][j] = randomLetter;
                            }
                        }
                    }
                },

                startWordSelection(row, col) {
                    this.isSelecting = true;
                    this.selectedCells = [{ row, col }];
                    this.currentWord = this.timeGrid[row][col];
                },

                continueWordSelection(row, col) {
                    if (!this.isSelecting) return;

                    // Check if this cell is adjacent to the last selected cell
                    const lastCell = this.selectedCells[this.selectedCells.length - 1];
                    const rowDiff = Math.abs(row - lastCell.row);
                    const colDiff = Math.abs(col - lastCell.col);

                    // Cell must be adjacent (including diagonals) and not already selected
                    if ((rowDiff <= 1 && colDiff <= 1) &&
                        !this.selectedCells.some(cell => cell.row === row && cell.col === col)) {

                        // Check if selection follows a straight line
                        if (this.selectedCells.length <= 1 || this.isInLine(row, col)) {
                            this.selectedCells.push({ row, col });
                            this.currentWord = this.selectedCells.map(cell => this.timeGrid[cell.row][cell.col]).join('');
                        }
                    }
                },

                isInLine(row, col) {
                    if (this.selectedCells.length < 2) return true;

                    // Get the direction from first to second cell
                    const first = this.selectedCells[0];
                    const second = this.selectedCells[1];

                    const rowDir = second.row - first.row;
                    const colDir = second.col - first.col;

                    // Check if the new cell follows the same direction
                    const last = this.selectedCells[this.selectedCells.length - 1];
                    return (row - last.row === rowDir && col - last.col === colDir);
                },

                handleTouchMove(event, gridRow, gridCol) {
                    if (!this.isSelecting) return;

                    // Get touch position relative to the grid
                    const touch = event.touches[0];
                    const gridElement = event.currentTarget.parentElement;
                    const rect = gridElement.getBoundingClientRect();

                    // Calculate which cell the touch is over
                    const cellSize = rect.width / 10; // 10x10 grid
                    const touchRow = Math.floor((touch.clientY - rect.top) / cellSize);
                    const touchCol = Math.floor((touch.clientX - rect.left) / cellSize);

                    // Only process if touch is within grid bounds
                    if (touchRow >= 0 && touchRow < 10 && touchCol >= 0 && touchCol < 10) {
                        this.continueWordSelection(touchRow, touchCol);
                    }
                },

                endWordSelection() {
                    if (!this.isSelecting) return;

                    this.isSelecting = false;

                    // Check if the selected word is in the list
                    const selectedWord = this.currentWord;
                    const reversedWord = selectedWord.split('').reverse().join('');

                    if (this.timeWords.includes(selectedWord) && !this.foundWords.includes(selectedWord)) {
                        // Word found!
                        this.foundWords.push(selectedWord);
                        this.timeScore += selectedWord.length * 5;
                        this.playSound('correctSound');

                        // Check if all words are found
                        if (this.foundWords.length === this.timeWords.length) {
                            // Apply bonus for finding all words
                            this.timeScore += 50;
                            setTimeout(() => {
                                this.endTimeMode();
                            }, 1000);
                        }
                    } else if (this.timeWords.includes(reversedWord) && !this.foundWords.includes(reversedWord)) {
                        // Found word in reverse
                        this.foundWords.push(reversedWord);
                        this.timeScore += reversedWord.length * 5;
                        this.playSound('correctSound');

                        // Check if all words are found
                        if (this.foundWords.length === this.timeWords.length) {
                            // Apply bonus for finding all words
                            this.timeScore += 50;
                            setTimeout(() => {
                                this.endTimeMode();
                            }, 1000);
                        }
                    } else {
                        this.playSound('wrongSound');
                    }

                    // Reset selection
                    this.selectedCells = [];
                    this.currentWord = '';
                },

                isHighlighted(row, col) {
                    return this.isSelecting && this.selectedCells.some(cell => cell.row === row && cell.col === col);
                },

                isInFoundPath(row, col) {
                    // Check if this cell is part of any found word
                    for (const word of this.foundWords) {
                        const wordPositions = this.getWordPositions(word);
                        if (wordPositions.some(pos => pos.row === row && pos.col === col)) {
                            return true;
                        }
                    }
                    return false;
                },

                getWordPositions(word) {
                    // Search for the word in the grid and return its positions
                    const positions = [];

                    // Check horizontal, vertical, and diagonal
                    const directions = [
                        { rowDir: 0, colDir: 1 },  // Horizontal
                        { rowDir: 1, colDir: 0 },  // Vertical
                        { rowDir: 1, colDir: 1 },  // Diagonal down
                        { rowDir: -1, colDir: 1 }  // Diagonal up
                    ];

                    for (let row = 0; row < 10; row++) {
                        for (let col = 0; col < 10; col++) {
                            for (const direction of directions) {
                                let found = true;
                                const wordPositions = [];

                                for (let i = 0; i < word.length; i++) {
                                    const r = row + i * direction.rowDir;
                                    const c = col + i * direction.colDir;

                                    if (r < 0 || r >= 10 || c < 0 || c >= 10 || this.timeGrid[r][c] !== word[i]) {
                                        found = false;
                                        break;
                                    }

                                    wordPositions.push({ row: r, col: c });
                                }

                                if (found) {
                                    return wordPositions;
                                }

                                // Also check in reverse
                                found = true;
                                const reversePositions = [];

                                for (let i = 0; i < word.length; i++) {
                                    const r = row + i * direction.rowDir;
                                    const c = col + i * direction.colDir;

                                    if (r < 0 || r >= 10 || c < 0 || c >= 10 || this.timeGrid[r][c] !== word[word.length - 1 - i]) {
                                        found = false;
                                        break;
                                    }

                                    reversePositions.push({ row: r, col: c });
                                }

                                if (found) {
                                    return reversePositions;
                                }
                            }
                        }
                    }

                    return positions;
                },

                endTimeMode() {
                    clearInterval(this.timerInterval);

                    // Calculate coins earned based on score
                    this.earnedCoins = Math.floor(this.timeScore / 10) + this.foundWords.length * 3;
                    this.coins += this.earnedCoins;

                    // Update best score if needed
                    if (this.timeScore > this.stats.bestScore) {
                        this.stats.bestScore = this.timeScore;
                    }

                    // Update daily progress
                    this.dailyProgress++;

                    this.showTimeResultModal = true;
                    this.saveData();
                },

                formatTime(seconds) {
                    const mins = Math.floor(seconds / 60);
                    const secs = seconds % 60;
                    return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
                },

                claimFreeCoins() {
                    this.coins += 100;
                    this.claimedFreeCoins = true;
                    this.playSound('coinSound');
                    this.saveData();
                },

                quitGame() {
                    clearInterval(this.timerInterval);
                    this.confirmQuit = false;
                    this.currentScreen = 'menu';
                },

                resetProgress() {
                    if (confirm("Are you sure you want to reset all progress? This cannot be undone.")) {
                        this.coins = 0;
                        this.claimedFreeCoins = false;
                        this.dailyProgress = 0;
                        this.stats = { totalGames: 0, wordsLearned: 0, bestScore: 0 };
                        this.learnedTerms = [];
                        this.inventory = {
                            anesthesia: 0,
                            hints: 0,
                            timeBonus: 0,
                            wordReveal: 0,
                            unlockedPacks: [],
                            activeTheme: 'default',
                            ownedThemes: []
                        };
                        this.saveData();
                        alert("Progress reset successfully.");
                    }
                },

                exportData() {
                    const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify({
                        coins: this.coins,
                        stats: this.stats,
                        learnedTerms: this.learnedTerms,
                        inventory: this.inventory
                    }));

                    const downloadAnchorNode = document.createElement('a');
                    downloadAnchorNode.setAttribute("href", dataStr);
                    downloadAnchorNode.setAttribute("download", "medword_data.json");
                    document.body.appendChild(downloadAnchorNode);
                    downloadAnchorNode.click();
                    downloadAnchorNode.remove();
                },

                shuffleArray(array) {
                    for (let i = array.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [array[i], array[j]] = [array[j], array[i]];
                    }
                    return array;
                }
            };
        }
    </script>

    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        }

        // PWA Installation Promotion
        let deferredPrompt;
        const installButton = document.createElement('button');
        installButton.style.display = 'none';
        installButton.classList.add('fixed', 'bottom-4', 'right-4', 'bg-primary-gradient', 'text-white', 'font-bold', 'py-2', 'px-4', 'rounded-full', 'shadow-lg', 'z-50');
        installButton.innerHTML = 'Install MedWord <span class="ml-1"></span>';
        document.body.appendChild(installButton);

        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent Chrome 67 and earlier from automatically showing the prompt
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;
            // Update UI to notify the user they can add to home screen
            installButton.style.display = 'block';
        });

        installButton.addEventListener('click', (e) => {
            // Hide the app provided install promotion
            installButton.style.display = 'none';
            // Show the install prompt
            deferredPrompt.prompt();
            // Wait for the user to respond to the prompt
            deferredPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === 'accepted') {
                    console.log('User accepted the install prompt');
                } else {
                    console.log('User dismissed the install prompt');
                }
                deferredPrompt = null;
            });
        });

        // Handle installed PWAs
        window.addEventListener('appinstalled', (evt) => {
            console.log('MedWord was installed');
        });
    </script>
</body>

</html>